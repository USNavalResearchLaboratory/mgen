<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>MGEN User's and Reference Guide Version 5.0</title><link rel="stylesheet" type="text/css" href="html.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><meta name="description" content="The Multi-Generator (MGEN) is open source software by the Naval Research Laboratory (NRL) PROTocol Engineering Advanced Networking (PROTEAN) group which provides the ability to perform IP network performance tests and measurements using UDP and TCP IP traffic. The toolset generates real-time traffic patterns so that the network can be loaded in a variety of ways. The generated traffic can also be received and logged for analyses. Script files are used to drive the generated loading patterns over the course of time. These script files can be used to emulate the traffic patterns of unicast and/or multicast UDP and TCP IP applications. The tool set can be scripted to dynamically join and leave IP multicast groups. MGEN log data can be used to calculate performance statistics on throughput, packet loss rates, communication delay, and more. MGEN currently runs on various Unix-based (including MacOS X) and WIN32 platforms. The principal tool is the mgen program which can generate, receive, and log test traffic. This document provides information on mgen usage, message payload, and script and log file formats. Additional tools are available to facilitate automated script file creation and log file analyses."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article"><div class="titlepage"><div><div><h2 class="title"><a name="d0e2"></a><span class="inlinemediaobject"><img src="resources/mgenLogo.gif"></span><span class="inlinemediaobject"><img src="resources/drecLogo.gif"></span>MGEN User's and Reference Guide Version 5.0</h2></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>The Multi-Generator (MGEN) is open source software by the <a class="ulink" href="http://www.nrl.navy.mil/" target="_top">Naval Research Laboratory</a> (NRL) PROTocol Engineering Advanced Networking (PROTEAN) group which provides the ability to perform IP network performance tests and measurements using UDP and TCP IP traffic. The toolset generates real-time traffic patterns so that the network can be loaded in a variety of ways. The generated traffic can also be received and logged for analyses. Script files are used to drive the generated loading patterns over the course of time. These script files can be used to emulate the traffic patterns of unicast and/or multicast UDP and TCP IP applications. The tool set can be scripted to dynamically join and leave IP multicast groups. MGEN log data can be used to calculate performance statistics on throughput, packet loss rates, communication delay, and more. MGEN currently runs on various Unix-based (including MacOS X) and WIN32 platforms.</p><p>The principal tool is the mgen program which can generate, receive, and log test traffic. This document provides information on mgen usage, message payload, and script and log file formats. Additional tools are available to facilitate automated script file creation and log file analyses.</p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="sect1"><a href="#Quick_Link">1. Quick Links</a></span></dt><dt><span class="sect1"><a href="#_Mgen_Usage">2. Mgen Usage</a></span></dt><dd><dl><dt><span class="sect2"><a href="#Example_Usage">2.1. Example Usage</a></span></dt><dt><span class="sect2"><a href="#_EXAMPLE_SCRIPT">2.2. Example Script</a></span></dt></dl></dd><dt><span class="sect1"><a href="#Command-line_Options">3. Command-line Options</a></span></dt><dt><span class="sect1"><a href="#MGEN_Run-Time_Remote_Control">4. MGEN Run-Time Remote Control</a></span></dt><dt><span class="sect1"><a href="#_MGEN_Script_Format">5. MGEN Script Format</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_Transmission_Events">5.1. Transmission Events</a></span></dt><dd><dl><dt><span class="sect3"><a href="#_ON_Event">5.1.1. ON Event</a></span></dt><dt><span class="sect3"><a href="#_MOD_Event">5.1.2. MOD Event</a></span></dt><dt><span class="sect3"><a href="#_OFF_Event">5.1.3. OFF Event</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_Transmission_Event_Options">5.2. Transmission Event Options</a></span></dt><dd><dl><dt><span class="sect3"><a href="#Protocol__UDP_TCP_SINK">5.2.1. Protocol (UDP/TCP/SINK)</a></span></dt><dt><span class="sect3"><a href="#Destination__DST">5.2.2. Destination (DST)</a></span></dt><dt><span class="sect3"><a href="#_Source_Port_SRC">5.2.3. Source Port (SRC)</a></span></dt><dt><span class="sect3"><a href="#_COUNT">5.2.4. COUNT</a></span></dt><dt><span class="sect3"><a href="#Pattern__PER">5.2.5. Pattern (PERIODIC, POISSON, BURST, JITTER, CLONE, &lt;sizeMin:sizeMax&gt;)</a></span></dt><dt><span class="sect3"><a href="#_Broadcast">5.2.6. BROADCAST</a></span></dt><dt><span class="sect3"><a href="#_Logdata">5.2.7. LOGDATA</a></span></dt><dt><span class="sect3"><a href="#_Type-Of-Service_TOS">5.2.8. Type-Of-Service (TOS)</a></span></dt><dt><span class="sect3"><a href="#_Time-To-Live_TTL">5.2.9. Multicast/Unicast Time-To-Live (TTL)</a></span></dt><dt><span class="sect3"><a href="#_IPv6_Flow_Label">5.2.10. Socket Transmit Buffer Size (TXBUFFER)</a></span></dt><dt><span class="sect3"><a href="#Socket_Receive_Buffer_Size__RXBUFFER">5.2.11. Socket Receive Buffer Size (RXBUFFER)</a></span></dt><dt><span class="sect3"><a href="#IPv6_Flow_Label__LABEL">5.2.12. IPv6 Flow Label (LABEL)</a></span></dt><dt><span class="sect3"><a href="#Multicast_Interface__INTERFACE">5.2.13. Multicast Interface (INTERFACE)</a></span></dt><dt><span class="sect3"><a href="#Sequence_Number_Initialization__SEQUENCE">5.2.14. Sequence Number Initialization (SEQUENCE)</a></span></dt><dt><span class="sect3"><a href="#d0e1437">5.2.15. UDP Connect (CONNECT)</a></span></dt><dt><span class="sect3"><a href="#d0e1454">5.2.16. DF (fragmentation bit)</a></span></dt><dt><span class="sect3"><a href="#_FLOW_REPORT">5.2.17. REPORT</a></span></dt><dt><span class="sect3"><a href="#_SUSPEND">5.2.18. SUSPEND</a></span></dt><dt><span class="sect3"><a href="#_RESUME">5.2.19. RESUME</a></span></dt><dt><span class="sect3"><a href="#_RESET">5.2.20. RESET</a></span></dt><dt><span class="sect3"><a href="#_RESET">5.2.21. RETRY</a></span></dt></dl></dd><dt><span class="sect2"><a href="#_Reception_Events">5.3. Reception Events</a></span></dt><dd><dl><dt><span class="sect3"><a href="#_LISTEN">5.3.1. LISTEN</a></span></dt><dt><span class="sect3"><a href="#_IGNORE">5.3.2. IGNORE</a></span></dt><dt><span class="sect3"><a href="#_JOIN">5.3.3. JOIN</a></span></dt><dt><span class="sect3"><a href="#_LEAVE">5.3.4. LEAVE</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#_Global_Commands">6. Global Commands</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_START">6.1. START</a></span></dt><dt><span class="sect2"><a href="#_OFFSET">6.2. OFFSET</a></span></dt><dt><span class="sect2"><a href="#_TOS">6.3. TOS</a></span></dt><dt><span class="sect2"><a href="#_LABEL">6.4. LABEL</a></span></dt><dt><span class="sect2"><a href="#_TTL">6.5. TTL</a></span></dt><dt><span class="sect2"><a href="#_TUNICAST_TTL">6.6. UNICAST_TTL</a></span></dt><dt><span class="sect2"><a href="#_TXBUFFER">6.7. TXBUFFER</a></span></dt><dt><span class="sect2"><a href="#_RXBUFFER">6.8. RXBUFFER</a></span></dt><dt><span class="sect2"><a href="#_LOCALTIME">6.9. LOCALTIME</a></span></dt><dt><span class="sect2"><a href="#_QUEUE">6.10. QUEUE</a></span></dt><dt><span class="sect2"><a href="#d0e2244">6.11. DATA</a></span></dt><dt><span class="sect2"><a href="#_INTERFACE">6.12. INTERFACE</a></span></dt><dt><span class="sect2"><a href="#_INPUT">6.13. INPUT</a></span></dt><dt><span class="sect2"><a href="#_OUTPUT">6.14. OUTPUT</a></span></dt><dt><span class="sect2"><a href="#_LOG">6.15. LOG</a></span></dt><dt><span class="sect2"><a href="#_LOGDATA">6.16. LOGDATA</a></span></dt><dt><span class="sect2"><a href="#_SAVE">6.17. SAVE</a></span></dt><dt><span class="sect2"><a href="#d0e2419">6.18. SEED</a></span></dt><dt><span class="sect2"><a href="#_IPV6">6.19. IPv6</a></span></dt><dt><span class="sect2"><a href="#_IPV4">6.20. IPv4</a></span></dt><dt><span class="sect2"><a href="#_DF">6.21. DF</a></span></dt><dt><span class="sect2"><a href="#_ANALYTICS">6.22. ANALYTICS</a></span></dt><dt><span class="sect2"><a href="#_WINDOW">6.23. WINDOW</a></span></dt><dt><span class="sect2"><a href="#_REPORT">6.24. REPORT</a></span></dt><dt><span class="sect2"><a href="#_SUSPEND_GLOBAL">6.25. SUSPEND</a></span></dt><dt><span class="sect2"><a href="#_RESUME_GLOBAL">6.26. RESUME</a></span></dt><dt><span class="sect2"><a href="#_RESET_GLOBAL">6.27. RESET</a></span></dt><dt><span class="sect2"><a href="#_RETRY_GLOBAL">6.28. RETRY</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_MGEN_Log_File">7. MGEN Log File Format</a></span></dt><dd><dl><dt><span class="sect2"><a href="#General_Log_Format">7.1. General Log Format</a></span></dt><dt><span class="sect2"><a href="#_Log_File_RECV">7.2. Log File RECV Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_RERR">7.3. Log File RERR Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_SEND_Events">7.4. Log File SEND Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_JOIN">7.5. Log File JOIN Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_LEAVE">7.6. Log File LEAVE Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_LISTEN">7.7. Log File LISTEN Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_IGNORE">7.8. Log File IGNORE Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_ON">7.9. Log File ON Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_CONNECT">7.10. Log File CONNECT Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_ACCEPT">7.11. Log File ACCEPT Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_SHUTDOWN">7.12. Log File SHUTDOWN Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_DISCONNECTED">7.13. Log File DISCONNECT Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_RECONNECT">7.14. Log File RECONNECT Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_OFF">7.15. Log File OFF Events</a></span></dt><dt><span class="sect2"><a href="#_Log_File_Start_Stop">7.16. Log File START and STOP Events</a></span></dt><dt><span class="sect2"><a href="#_LOG_FILE_REPORT_EVENTS">7.17. Log File REPORT Events</a></span></dt></dl></dd><dt><span class="sect1"><a href="#Binary_Log_File_Format">8. Binary Log File Format</a></span></dt><dd><dl><dt><span class="sect2"><a href="#_Binary_Log_File_RECV_Events">8.1. Binary Log File RECV Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_TCP_Connection_Event">8.2. Binary Log File TCP Connection Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_RERR_Events">8.3. Binary Log File RERR Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_SEND_Events">8.4. Binary Log File SEND Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_LISTEN_IGNORE_Event">8.5. Binary Log File LISTEN/IGNORE Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_JOIN_LEAVE_Event">8.6. Binary Log File JOIN/LEAVE Events</a></span></dt><dt><span class="sect2"><a href="#Binary_Log_File_START_STOP_Event">8.7. Binary Log File START/STOP Events</a></span></dt></dl></dd><dt><span class="sect1"><a href="#_MGEN_Message_Payload">9. MGEN Message Payload</a></span></dt><dt><span class="sect1"><a href="#d0e3479">10. Compile options</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e3483">10.1. RANDOM_FILL</a></span></dt><dt><span class="sect2"><a href="#d0e3488">10.2. HAVE_IPV6</a></span></dt><dt><span class="sect2"><a href="#d0e3493">10.3. SIMULATE</a></span></dt><dt><span class="sect2"><a href="#d0e3498">10.4. HAVE_GPS</a></span></dt><dt><span class="sect2"><a href="#d0e3503">10.5. HAVE_PCAP</a></span></dt><dt><span class="sect2"><a href="#d0e3508">10.6. Other</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e3513">11. Known issues</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e3517">11.1. Macosx Windows TCP Interaction</a></span></dt><dt><span class="sect2"><a href="#d0e3522">11.2. Windows Buffer Sizes</a></span></dt></dl></dd></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Quick_Link"></a>1.&nbsp;Quick Links</h2></div></div></div><p>The Multi-Generator (MGEN) is open source software by the <a class="ulink" href="http://www.nrl.navy.mil/" target="_top">Naval Research Laboratory</a> (NRL) PROTocol Engineering Advanced Networking (PROTEAN) group which provides the ability to perform IP network performance tests and measurements using UDP and TCP IP traffic. The toolset generates real-time traffic patterns so that the network can be loaded in a variety of ways. The generated traffic can also be received and logged for analyses. Script files are used to drive the generated loading patterns over the course of time. These script files can be used to emulate the traffic patterns of unicast and/or multicast UDP and TCP IP applications. The tool set can be scripted to dynamically join and leave IP multicast groups. MGEN log data can be used to calculate performance statistics on throughput, packet loss rates, communication delay, and more. MGEN currently runs on various Unix-based (including MacOS X) and WIN32 platforms.</p><p>The principal tool is the mgen program which can generate, receive, and log test traffic. This document provides information on mgen usage, message payload, and script and log file formats. Additional tools are available to facilitate automated script file creation and log file analyses.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="#_Mgen_Usage" title="2.&nbsp;Mgen Usage">Mgen Usage</a></p></li><li class="listitem"><p><a class="link" href="#_MGEN_Script_Format" title="5.&nbsp;MGEN Script Format">Mgen Script File Format</a></p></li><li class="listitem"><p><a class="link" href="#_MGEN_Log_File" title="7.&nbsp;MGEN Log File Format">Mgen Log File Format</a></p></li><li class="listitem"><p><a class="link" href="#_MGEN_Message_Payload" title="9.&nbsp;MGEN Message Payload">Mgen Message Payload</a></p></li><li class="listitem"><p><a class="ulink" href="http://pf.itd.nrl.navy.mil/proteantools/trpr.html" target="_top">TRPR Log File Analysis Program</a></p></li><li class="listitem"><p><a class="ulink" href="http://pf.itd.nrl.navy.mil/proteantools/gpsLogger.html" target="_top">gpsLogger GPS Utility</a></p></li><li class="listitem"><p><a class="ulink" href="mgen-tech.html" target="_top">Mgen Technical Documentation</a></p></li></ul></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_Mgen_Usage"></a>2.&nbsp;Mgen Usage</h2></div></div></div><p>The mgen version 5.0 program must currently be launched from a command-line. In the future, a simple graphical user interface similar to that of mgen version 3.x will be provided to simplify management of multiple sender and receiver instances. To launch mgen use the following command-line syntax:</p><pre class="programlisting">mgen [ipv4][ipv6][input &lt;scriptFile&gt;][save &lt;saveFile&gt;]
     [output &lt;logFile&gt;][log &lt;logFile&gt;]
     [binary][txlog][nolog][flush][hostAddr {on|off}]
     [event "&lt;mgen event&gt;"][port &lt;recvPortList&gt;]
     [instance &lt;name&gt;][command &lt;cmdInput&gt;]
     [sink &lt;sinkFile&gt;][block][source &lt;sourceFile&gt;]
     [interface &lt;interfaceName&gt;][ttl &lt;multicastTimeToLive&gt;]
     [unicast_ttl &lt;unicastTimeToLive&gt;]
     [tos &lt;typeOfService&gt;][label &lt;value&gt;]
     [txbuffer &lt;txSocketBufferSize&gt;]
     [rxbuffer &lt;rxSocketBufferSize&gt;]
     [start &lt;hr:min:sec&gt;[GMT]][offset &lt;sec&gt;]
     [precise {on|off}][ifinfo &lt;ifName&gt;]
     [txcheck][rxcheck][check][stop]
     [convert &lt;binaryLog&gt;][debug &lt;debugLevel&gt;]
     [localtime &lt;localtime&gt;] [queue &lt;queue&gt;]
     [broadcast {on|off}] [logdata {on|off}]
     [loggpsdata {on|off}] [gpsfile &lt;fileName&gt;]
     [df {on|off}][analytics] [window &lt;secs&gt;]]
     [report] [suspend &lt;flowId(s)&gt;] [resume &lt;flowId(s)&gt;] [reset &lt;flowId(s)&gt;]
     [retry &lt;count&gt;[/&lt;delay&gt;]
     [epochtimestamp]

</pre><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Example_Usage"></a>2.1.&nbsp;Example Usage</h3></div></div></div><p>To run mgen with script file "script.mgn" and log to stdout (by default):<code class="literal"></code></p><p><code class="literal">mgen input script.mgn</code></p><p>To monitor ports 5000,5004,5005, and 5006 for received UDP traffic and log to a specific file "log.drc":<code class="literal"></code></p><p><code class="literal">mgen port 5000,5004-5006 output log.drc</code></p><p>The "event" command can be used to achieve equivalent operation with the command-line syntax:<code class="literal"></code></p><p><code class="literal">mgen event "listen udp 5000,5004-5006" output log.drc</code></p><p>The "event" command allows for use of mgen without script files for "quick and dirty" runs. In the future, MGEN will be capable of being dynamically scripted during run time with "event" commands passed to MGEN via inter-process communication.</p><p><span class="emphasis"><em>Note: In previous versions, two different programs (each with different scripts) were used to separately generate and receive test traffic. The traffic generation capability of the former mgen program and the receive-side functionality of the Dynamic-Receiver (drec) program have now been integrated into a single executable mgen program.</em></span></p><p>The file extensions ".mgn" for MGEN scripts and ".drc" for MGEN log files are suggested conventions that users might wish to use for consistency. The ".drc" naming is in honor of the deprecated drec program.</p><p>The "sink" and "source" commands can be used to stream MGEN messages via alternative transport processes (e.g. reliable multicast, ssh, peer-to-peer protocols, etc). Here is an example using ssh to set up a TCP connection to a remote machine, start an mgen receiver at the remote machine to log receive messages, and attempt to transmit a 2 Mbps stream of MGEN messages via the ssh connection:<code class="literal"></code></p><p><code class="literal">mgen event "ON 1 SINK DST 127.0.0.1/5001 PERIODIC [200 1250]" \ sink STDOUT output /dev/null | ssh &lt;remoteHost&gt; sh -c "cat | \ mgen source STDIN output mgenLog.drc"</code></p><p>Note that the mgen executable must be present on the remote machine. Also note the importance of directing the MGEN sender's log output to /dev/null so that it doesn't get piped to the ssh process, mixed with the binary "sink" message stream.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_EXAMPLE_SCRIPT"></a>2.2.&nbsp;Example Script</h3></div></div></div><p>Below is an example MGEN script which generates two "flows" of UDP traffic and sends a single 1 megabyte TCP message. In this example, UDP flow 1 is sent to the loopback interface address (127.0.0.1) port 5001 and UDP flow 2 is sent to an IP multicast group on port number 5002. Flow 3 will send a 1 megabyte tcp "message" as it is turned off immediately after being started. (Note that the targeted TCP server must be listening for tcp connections on the port specified). Locally, a LISTEN command is used to monitor these (and other) ports so that mgen can receive its own traffic for demonstration purposes. This script illustrates the usage of a number of MGEN script commands.<code class="literal"></code></p><pre class="programlisting"># MGEN script begins here
# These are some "Transmission Event" script lines

# Originate two UDP flows

0.0 ON 1 UDP SRC 5001 DST 127.0.0.1/5001 PERIODIC [1 1024]
0.0 ON 2 UDP SRC 5002 DST 224.225.1.2/5002 PERIODIC [1 512]

# These script lines send a single 1 megabyte TCP mgen message
# Note that the "mgen message" will be received in multiple
# "mgen fragments" by the target node.

0.0 ON 1 TCP DST 10.0.0.1/5000 PERIODIC [1 1048576] COUNT 1

# Modify the pattern/rate of flow 2 4 seconds into the test

4.0 MOD 2 POISSON [10 1024]

# These are some "Reception Event" script lines
# Monitor some ports for UDP traffic

0.0 LISTEN UDP 5000-5002,6000,6003

# Join an IP multicast group
0.0 JOIN 224.225.1.2 INTERFACE eth0

# Join a SSM multicast group (Supported only for *nix)
#0.0 JOIN 232.1.1.1 SRC 25.25.25.1 INTERFACE eth0

# For WIN32, use the "PORT" option
0.0 JOIN 224.225.1.2 PORT 5002

# For OSX use the "interface" option if a default multicast route is not defined
#0.0 JOIN 224.1.2.3 interface en0

# Join a multicast group across a range of ports
0.0 JOIN 224.1.2.5 PORT 5005-5010

# On IPv6 systems set the port option when IPv4 group membership is requested
0.0 JOIN 224.1.2.4 port 5001

# Later, leave the group
5.0 LEAVE 224.225.1.2 INTERFACE eth0

# This SSM LEAVE is for UNIX (Currently SSM is supported only in UNIX)
#5.0 LEAVE 224.224.1.2 SRC 25.25.25.1 INTERFACE eth0

# Incrementally ignore some receive traffic
6.0 IGNORE UDP 5000-500
18.0 IGNORE UDP 5001,6000,6003

# More MGEN lines (terminate the flows)
10.0 OFF 
110.0 OFF 2

# MGEN script ends here</pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Command-line_Options"></a>3.&nbsp;Command-line Options</h2></div></div></div><p>Some of these command-line options can also be included in MGEN script files as "global" commands or defaults. Note the command-line (or commands sent via MGEN's remote control interface) will always override settings from script files.</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="48%"><col width="52%"></colgroup><tbody><tr><td><code class="literal"><span id="_IPV4"><a class="link" href="#_IPV4"></a><a name="_IPV4"></a><a class="link" href="#_IPV4">ipv4</a></span></code></td><td>Forces mgen to open sockets for IPv4 operation (i.e. AF_INET domain sockets) only. The default behavior for mgen is to open sockets with the domain based on environment and the type of IP addresses used in the script file used.</td></tr><tr><td><code class="literal"><span id="_IPV6"><a class="link" href="#_IPV6"></a><a name="_IPV6"></a><a class="link" href="#_IPV6">ipv6</a></span></code></td><td>Forces mgen to open sockets for IPv6 operation (i.e. AF_INET6 domain sockets) only. The default behavior for mgen is to open sockets with the domain based on environment and the type of IP addresses used in the script file used.</td></tr><tr><td><code class="literal"><span id="_DF"><a class="link" href="#_DF"></a><a name="_DF"></a><a class="link" href="#_DF">df {ON|OFF}</a></span></code></td><td>Controls whether the DF fragmentation bit is set. {ON|OFF}</td></tr><tr><td><code class="literal">input&lt;scriptFile&gt;</code></td><td>Causes mgen to parse the given &lt;scriptFile&gt; at startup and schedule any transmission or reception events given in the script.</td></tr><tr><td><code class="literal">save&lt;saveFile&gt;</code></td><td>Causes mgen to save the sequence number state of any pending transmit flows and the current relative script "offset" time to &lt;saveFile&gt; in the form of an MGEN script. The &lt;saveFile&gt; may be used as an additional input script on a subsequent launch of mgento return mgen to the same state as when previously exited. See the equivalent global <a class="link" href="#_SAVE" title="6.17.&nbsp;SAVE">SAVE</a> command for further detail on usage.</td></tr><tr><td><code class="literal">output&lt;logFile&gt;</code></td><td>Cause mgen to output logged information to the indicated &lt;logFile&gt;. By default, mgen will log to stdout. With the output command, an existing &lt;logFile&gt; of the same name will be overwritten. Use the log command to append to an existing log file.</td></tr><tr><td><code class="literal">log&lt;logFile&gt;</code></td><td>This is the same as the output command except that if &lt;logFile&gt; already exists, it will be appended instead of replaced.</td></tr><tr><td><code class="literal">binary</code></td><td>Causes mgen to save output logging information in a smaller-sized binary file format. This option should come before the output or log command.</td></tr><tr><td><code class="literal">txlog</code></td><td>This enables transmission logging. This results in <a class="link" href="#_Log_File_SEND_Events" title="7.4.&nbsp;Log File SEND Events">SEND</a> events being added to the log file every time a packet is sent by mgen.</td></tr><tr><td><code class="literal">nolog</code></td><td>This disables logging completely.</td></tr><tr><td><code class="literal">flush</code></td><td>This causes the output log file to be flushed with each line written. This is useful for real-time monitoring of MGEN logging</td></tr><tr><td><code class="literal">hostAddr {on|off}</code></td><td>Turning this option on causes mgen to include the "host" field in MGEN messages sent. The "host" field contains an educated guess of the machines local IP address to help identify the source of messages in log files. When the "host" field is present, MGEN log file SEND and RECV events contain a "host&gt;" field indicating the sender's original address. This can be useful when Network Address Translation (NAT) or other tunneling occurs in test networks.</td></tr><tr><td><code class="literal">event"&lt;mgen event&gt;"</code></td><td>The event command allows the user to enter the equivalent of MGEN script lines into mgen via the command-line. Multiple event commands can be used to pass the equivalent of a multi-line script to MGEN. Note that MGEN script events generally contain spaces and thus must be encapsulated in quotes on the command line. Note that the &lt;eventTime&gt; may be omitted and the action indicated will be taken by mgen immediately. When the <p><span class="emphasis"><em></em></span></p><p><span class="emphasis"><em>event</em></span></p>command is issued during run-time, the &lt;eventTime&gt; (if provided) specifies a delay relative to the current time (e.g. the event will occur with after the given delay).</td></tr><tr><td><code class="literal">instance&lt;instanceName&gt;</code></td><td>If a pre-existing mgen application instance is _not_ already running, this command registers the running mgen program as an instance identified by the &lt;instanceName&gt;. On UNIX, this corresponds to a Unix-domain datagram socket named "/tmp/&lt;instanceName&gt;" being opened and monitored for MGEN commands (On WIN32, a "mailslot" named "\\.\mailslot\&lt;instanceName&gt;" is created and used). These interprocess channels allow for run-time control of mgen processes. This is the preferred methodology for run-time control of the mgen application.If an application instance as identified by the &lt;instanceName&gt; parameter is already running, any subsequent command-line options are transmitted to the remote instance already running, and the new mgen instance will then exit.This allows run-time control of possibly multiple background mgeninstances from the "shell" or via scripting. The <span class="emphasis"><em>event</em></span> command may be used to dispatch MGEN script events to mgen instances at run-time.</td></tr><tr><td><code class="literal">command{&lt;path&gt;|STDIN}</code></td><td>This specifies a file or device which mgen will monitor for run-time command input. If the "STDIN" key is used, mgenmonitors the "stdin" (console) input which can provide a crude run-time user interface for mgen. Commands sent to mgen in this fashion must be delimited by line-breaks or the ';' character. See the instance command for a more flexible, and the preferred option for mgen run-time control.</td></tr><tr><td><code class="literal">port&lt;recvPortList&gt;</code></td><td>Causes mgen to monitor the given port numbers for received UDP traffic. The format of the &lt;recvPortList&gt; is a comma-delimited list of individual or inclusive ranges of port values (No spaces allowed in the list). Note this is the equivalent of a scripted <p></p><p>0.0 LISTEN UDP &lt;recvPortList&gt;</p>reception event and can also be equivalently achieved with the <p><span class="emphasis"><em>event</em></span></p> command using the syntax:<p></p><code class="literal"> <code class="literal">mgen event "LISTEN UDP &lt;portList&gt;"Example:mgen port 5000,5002,5005-5009</code></code></td></tr><tr><td><code class="literal">sink&lt;sinkFile&gt;</code></td><td>Causes mgento use the file or device (e.g. stdout) indicated as a "sink" or destination for transmitted message flows of protocol type "SINK". I.e., MGEN message flows of type "SINK" are written to the "sink" device instead of to a UDP or TCP socket. Piping mgen output to stdout allows MGEN messages to use alternative transport provided by another process (e.g. ssh, <a class="ulink" href="http://cs.itd.nrl.navy.mil/work/norm/" target="_top">norm</a>, etc). The special &lt;sinkFile&gt; value "STDOUT" will direct MGEN SINK flows to the mgen process stdout.</td></tr><tr><td><code class="literal">source&lt;sourceFile&gt;</code></td><td>This is the complement to the <p><span class="emphasis"><em>sink</em></span></p>command. This allows mgen to directly receive a binary stream of MGEN messaging from the &lt;sourceFile&gt; which may be the piped stdoutfrom another process (e.g. ssh, <a class="ulink" href="http://cs.itd.nrl.navy.mil/wowrk/norm" target="_top">norm</a>, etc). The special &lt;sourceFile&gt; string "STDIN" causes mgen to get input from its stdin stream. Messages read from the &lt;sourceFile&gt; (or stream) are time-stamped and logged in the MGEN log file as usual.</td></tr><tr><td><code class="literal">start&lt;hr:min:sec&gt;[GMT]</code></td><td>Causes mgen to delay processing events in script file relative to the indicated absolute time. The optional "GMT" keyword indicates the time is Greenwich Mean Time instead of the default local time. This command establishes an absolute time for the relative script time of 0.0 seconds.</td></tr><tr><td><code class="literal">offset&lt;sec&gt;</code></td><td>Causes mgen to skip &lt;sec&gt; seconds of relative time into the execution of the script file used. Note that if an absolute start time is given using the <code class="literal">start command,</code> the offset into the script will correspond to that absolute time. The default offset for MGEN is 0.0 seconds.</td></tr><tr><td><code class="literal">precise{on|off}</code></td><td>When the precise mode is enable, mgen performs polling (only as needed) to precisely time packet transmission. While this is sometimes helpful at high packet transmission rates, it comes at a cost of high CPU utilization by mgen. The default for this option is "off".</td></tr><tr><td><code class="literal">ifinfo&lt;interfaceName&gt;</code></td><td>This option can be used to have MGEN print a summary of statistics to stderr upon exit for the specified network interface. These stats include counts of frames sent/received. This can be used to augment/verify MGEN performance with or without logging enabled</td></tr><tr><td><code class="literal">convert&lt;binaryLogFile&gt;</code></td><td>Causes mgen to convert the indicated &lt;binaryLogFile&gt; to a text-based log file. The text-based log file information will be directed to stdout unless you specify a filename with the <span class="emphasis"><em>output</em></span> or <span class="emphasis"><em>log</em></span> command. Mgen will exit after the file conversion is complete.</td></tr><tr><td><code class="literal">interface&lt;interfaceName&gt;</code></td><td>Causes mgen to set the default network interface for IP multicast and/or root node flow transmission to &lt;interfaceName&gt;. &lt;interfaceName&gt; will override any default interface specified within an mgenscript file. &lt;interfaceName&gt; is a "per socket" attribute, and in its absence, MGEN will behave according to the operating system's default behavior.</td></tr><tr><td><code class="literal">ttl &lt;multicastTimeToLive&gt;</code></td><td>Causes mgen to set the hop count for IP multicast traffic generated by MGEN. &lt;multicastTimeToLive&gt; will override any default multicast ttl indicated within an mgen script file. &lt;timeToLive&gt; is a "per socket" attribute. If no ttl option is used, MGEN will set the default multicast ttl to 1.</td></tr><tr><td><code class="literal">unicast_ttl &lt;unicastTimeToLive&gt;</code></td><td>Causes mgen to set the hop count for IP unicast traffic generated by MGEN. &lt;unicastTimeToLive&gt; will override any default unicast ttl indicated within an mgen script file. &lt;unicastTimeToLive&gt; is a "per socket" attribute. If no unicast_ttl option is used, MGEN will set the default unicast ttl to 255.</td></tr><tr><td><code class="literal">tos&lt;typeOfService&gt;</code></td><td>Causes mgen to set the IPv4 type-of-service field (within the packet header) to &lt;typeOfService&gt;. &lt;typeOfService&gt; will override any default tos indicated within an mgen script file. As with ttl and interface, tos is a "per socket" attribute. If no tos option is used, MGEN will behave according to the operating system's default behavior.</td></tr><tr><td><code class="literal">label&lt;value&gt;</code></td><td>Causes mgen to set &lt;value&gt; as the <p><span class="emphasis"><em>default</em></span></p> flow label for IPv6 flows. The &lt;value&gt; corresponds to the 28-bit IPv6 flow label field and may be specified in decimal or hex.</td></tr><tr><td><code class="literal">txbuffer&lt;bufferSize&gt;</code></td><td>Causes mgen to set the socket transmit buffer size to a value ?at least? as large as &lt;bufferSize&gt;. If &lt;bufferSize&gt; is larger that the maximum allowed by the system, &lt;bufferSize&gt; will be set to the system maximum.</td></tr><tr><td><code class="literal">rxbuffer&lt;bufferSize&gt;</code></td><td>Causes mgento set the socket receive buffer size to a value ?at least? as large as &lt;bufferSize&gt;. If &lt;bufferSize&gt; is larger that the maximum allowed by the system, &lt;bufferSize&gt; will be set to the system maximum.</td></tr><tr><td><code class="literal">txcheck</code></td><td>Causes mgen to include an optional 32-bit cyclic redundancy checksum (CRC) at the end of its messages. The <code class="literal">CHECKSUM</code> flag is set to indicate the presence of the checksum content.</td></tr><tr><td><code class="literal">rxcheck</code></td><td>Forces mgen receivers to validate the checksum portion (last 4 bytes) of MGEN messages whether or not the CHECKSUM flag is set in the MGEN "flags" message field. Use this option when it is _known_ that the MGEN sender is supplying checksums to cover the case when the "flags" field itself is possibly corrupted.</td></tr><tr><td><code class="literal">check</code></td><td>Sets mgen behavior as if both the <span class="emphasis"><em>txcheck</em></span> _and_ <span class="emphasis"><em>rxcheck</em></span> commands were applied. This is the recommended option when MGEN checksum operation is desired so that both senders and receivers are providing and validating checksums, respectively.</td></tr><tr><td><code class="literal">stop</code></td><td>This command causes mgen to exit. This is useful for run-time control of mgen instances.</td></tr><tr><td><code class="literal">localtime</code></td><td>This enables logging of events and error messages in localtime. By default, events are logged in Greenwich Mean Time.</td></tr><tr><td><code class="literal">queue&lt;queueSize&gt;</code></td><td>This global command will cause mgen to buffer &lt;queueSize&gt; mgen packets for each flow during periods of congestion. (Note that flow specific limits specified at the transmission event level will override this global). When the number of pending messages for a flow exceeds this limit, the message transmission timer will be temporarily deactivated and any pending messages will transmitted as quickly as possible. The timer will be reactivated once the pending message count falls below the queue limit, and message transmission will return to the previously scheduled rate of transmission. If no global command is specified, a default &lt;queueSize&gt; of "0" will be in effect which will result in no queuing behavior, e.g. the transmission timer will continue to fire at its regularly scheduled interval regardless of transport congestion. No pending message count will be accumulated and message transmission will succeed or fail depending on transport availability. See <a class="link" href="#_QUEUE" title="6.10.&nbsp;QUEUE">QUEUE</a> for more details about the queueing mechanism.</td></tr><tr><td><code class="literal">broadcast {on|off}</code></td><td>Causes MGEN to set the socket option SO_BROADCAST to allow or disallow sending (and sometimes receiving) broadcasts from the socket. As with tos, ttl and interface, broadcast is a "per socket" attribute. By default BROADCAST is set to ON.</td></tr><tr><td><code class="literal">logdata {on|off}</code></td><td>Controls whether MGEN will log the optional data attribute field at MGEN receivers (including within MGEN binary log files). It does not affect whether MGEN senders send the requested data attribute. By default LOGDATA is set to ON.</td></tr><tr><td><code class="literal">loggpsdata {on|off}</code></td><td>Controls whether MGEN will log the gps data fields at MGEN receivers. It does not affect whether MGEN senders send the GPS data. By default LOGGPSDATA is set to ON. Note that as opposed to the logdata attribute, GPS data will be saved in any interim binary log file regardless of this flag. This flag only controls whether the gps data is logged in the formatted log files.</td></tr><tr><td><code class="literal">boost</code></td><td>The boost option sets the mgen process to realtime process priority. Care should be taken using the "precise" and "boost" options together as the mgen process can take over a machine at high packet rates (e.g. ctrl-c may not be handled).</td></tr><tr><td><code class="literal">gpsfile &lt;gpsFile&gt;</code></td><td>Changes the default location of the gps shared memory file to &lt;gpsFile&gt;</td></tr><tr><td><code class="literal">analytics</code></td><td>Enables built-in, per-flow analysis of received flows and outputs "<a class="link" href="#_FLOW_REPORT" title="5.2.17.&nbsp;REPORT">REPORT</a>" events to the mgen log file. The analysis (similar to NRL's TRPR tool) includes: <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>average received goodput rate for the given REPORT "window" time</p></li><li class="listitem"><p>loss fraction measured for the given REPORT "window" time</p></li><li class="listitem"><p>Average, minimum, and maximum latency for the given REPORT "window" time</p></li></ol></div><p>See <a class="link" href="#_ANALYTICS" title="6.22.&nbsp;ANALYTICS">analytics</a> for more detailed information.</p></td></tr><tr><td><code class="literal">window &lt;secs&gt;</code></td><td><p>Sets the analysis measurement window for analytics. See <a class="link" href="#_ANALYTICS" title="6.22.&nbsp;ANALYTICS">analytics</a> for more detailed information.</p></td></tr><tr><td><code class="literal">report</code></td><td>Enables analytic reporting in all transmitting flows.<p>See <a class="link" href="#_REPORT" title="6.24.&nbsp;REPORT">report</a> for more detailed information.</p></td></tr><tr><td><code class="literal">suspend &lt;flowId(s)|range&gt;</code></td><td>Suspends <span class="emphasis"><em>local</em></span> mgen flow(s) matching the given flow id, list of comma separated flow ids, or range.<p>See <a class="link" href="#_SUSPEND" title="5.2.18.&nbsp;SUSPEND">SUSPEND</a> for more detailed information.</p></td></tr><tr><td><code class="literal">resume &lt;flowId(s)|range&gt;</code></td><td>Resumes <span class="emphasis"><em>local</em></span> mgen flow(s) matching the given flow id, list of comma separated flow ids, or range. <p>See <a class="link" href="#_RESUME" title="5.2.19.&nbsp;RESUME">RESUME</a> for more detailed information.</p></td></tr><tr><td><code class="literal">reset &lt;flowId(s)|range&gt;</code></td><td>Resets <span class="emphasis"><em>local</em></span> mgen flow(s) matching the given flow id, list of comma separated flow ids, or range.<p>See <a class="link" href="#_RESET" title="5.2.20.&nbsp;RESET">RESET</a> for more detailed information.</p></td></tr><tr><td><code class="literal">retry &lt;count&gt;[/&lt;delay&gt;]</code></td><td>Sets the default retry behavior for all data flows. If the underlying TCP socket for a flow fails to connect, or disconnects, attempt to reconnect the socket &lt;count&gt; times after &lt;delay&gt; seconds. The default retry interval is 5 seconds. The transport will attempt to reconnect over the life of the flow if the retry count is set to -1. If multiple flows are sharing the transport a common retry pattern should be used by all the flows or the last attribute set "wins".</td></tr><tr><td><code class="literal">epochtimestamp</code></td><td>Log timestamps as epoch time in second.microsecond. format.</td></tr></tbody></table></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="MGEN_Run-Time_Remote_Control"></a>4.&nbsp;MGEN Run-Time Remote Control</h2></div></div></div><p>To use the mgen "remote control interface":</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Start one (or more) instance(s) of mgen to control:</p><p><code class="literal">mgen instance mgen1</code></p></li><li class="listitem"><p>Subsequent invocations of mgen with the same instance name will pass provided commands to the first instance and then exit:</p><p><code class="literal">mgen instance mgen1 event "on 1 udp dst 127.0.0.1/5000 periodic [1 1024]"</code></p></li></ol></div><p>The second instance (Step #2) will exit after it has passed its commands to the first running instance as identified by the &lt;instanceName&gt;. Note this can allow run-time control of multiple mgen instances by user(s), shell scripts, or other processes. A programmer comfortable with use of Unix-domain sockets (or WIN32 mailslots) or using the NRL Protolib "ProtoPipe" C++ class can also write software for run-time control of MGEN processes.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_MGEN_Script_Format"></a>5.&nbsp;MGEN Script Format</h2></div></div></div><p>MGEN scripts are text files containing a sequence of commands and scheduled events describing traffic generation patterns, ports and/or multicast groups to be monitored, and other options. Each line in the script corresponds to either a "<a class="link" href="#_Transmission_Events" title="5.1.&nbsp;Transmission Events">Transmission Event</a>", or "<a class="link" href="#_Reception_Events" title="5.3.&nbsp;Reception Events">Reception Event</a>", or "<a class="link" href="#_Global_Commands" title="6.&nbsp;Global Commands">Global Command</a>". Lengthy script lines can be continued to multiple text file lines by using a trailing backslash '\' character at the end of the line. Additionally, blank lines are permitted and comment lines can be included by providing a leading '#' character at the beginning of lines. (Note comment lines cannot be inserted in between "continued" script lines). Currently mgen is case-sensitive in parsing the script file format (commands, options, etc are all upper case), but will be modified to be case-insensitive in the future.</p><p>Scheduled transmission and reception events in the script use lines in the format of:<code class="literal"></code></p><p><code class="literal">[&lt;eventTime&gt;] &lt;eventType&gt; &lt;parameters ...&gt; [&lt;options ...&gt;]</code></p><p>These "events" are scheduled to be executed by MGEN at the relative time given by the &lt;eventTime&gt; field. The value of this field is a floating point number which denotes the relative time (in seconds) of the associated event. The time is relative to the start of the MGEN program or the time dictated by the global START command. If the &lt;eventTime&gt; is omitted, an &lt;eventTime&gt; of 0.0 (or immediately if MGEN is already started) is assumed (This can used with MGEN's "event" command to directly control the operation of ns-2 Agent/MGEN instances within an ns-2 TCL (Tool Command Language) script without use of an external MGEN script.</p><p>Global commands are generally used to define default behaviors for MGEN operation or other options independent of event scheduling. The format for global command script lines is:<code class="literal"></code></p><p><code class="literal">&lt;commandType&gt; [&lt;command parameters ...&gt;]</code></p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Transmission_Events"></a>5.1.&nbsp;Transmission Events</h3></div></div></div><p>MGEN "Transmission Event" script lines are used to schedule and characterize mgen traffic generation. An instance of mgen can simultaneously transmit traffic to multiple destinations with different patterns of transmission. The MGEN script format uses "flow identifiers" (&lt;flowIds&gt;) to tag specific "threads" of MGEN traffic generation. While the &lt;flowIds&gt; are placed in the payload of associated MGEN messages, the primary purpose of the &lt;flowId&gt; is to simply tie together a sequence of script "transmission events" as a single "flow" or "thread".</p><p>The sequence of events pertaining to a "flow" of MGEN traffic generation consist of <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a>, <a class="link" href="#_MOD_Event" title="5.1.2.&nbsp;MOD Event">MOD</a>, and <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> . The script line syntax for these event types is:</p><p><code class="literal">&lt;eventTime&gt; {ON|MOD|OFF} &lt;flowId&gt; [&lt;options ...&gt;]</code></p><p><code class="literal"></code>The first scripted event for a given flow identified by a &lt;flowId&gt; must be an <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> event. Subsequently, <a class="link" href="#_MOD_Event" title="5.1.2.&nbsp;MOD Event">MOD</a>, events can be used to modify characteristics of the given flow until it is terminated with an <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> event. After a flow has been terminated with the <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> command, a flow with the same &lt;flowId&gt; value may be initiated with another <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> event. The &lt;options&gt; fields are used to describe the characteristics of flows initiated with <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> events and modified with subsequence MOD events. The <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> event uses no options.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_ON_Event"></a>5.1.1.&nbsp;ON Event</h4></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; ON &lt;flowId&gt; &lt;protocol&gt; [connect] DST &lt;addr&gt;/&lt;port&gt; &lt;pattern [params]&gt; [&lt;options ...&gt;] [DATA [&lt;hex&gt;&lt;hex&gt;]]</code></p><p>This transmission event type is used to initiate a new flow at the time given by the &lt;eventTime&gt;. The &lt;flowId&gt; is used to identify the flow within the script and can be used by subsequent <a class="link" href="#_MOD_Event" title="5.1.2.&nbsp;MOD Event">MOD</a>, or <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> events to reference the flow initiated here.</p><p>The &lt;protocol&gt; field indicates the transport protocol to be used for the generated MGEN test messages. Current supported &lt;protocol&gt; types include "UDP", "TCP", and "SINK". The flow destination address and port must be specified for the <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> event using the DST option and the &lt;pattern&gt; of message generation must be given as well. Other flow &lt;options&gt; may be specified to further characterize the flow. User defined message payload can be specified with the DATA command. The data should be a hexadecimal representation of the user data where each pair of characters corresponds to one byte of user data.</p><p>The "UDP" and "TCP" protocol types encapsulate generated MGEN messages for the flow into IP packets for the appropriate protocol and transmit them over the network. (Note that an mgen instance must be "listening" for a TCP connection on the destination port at the target node or the connection attempt will fail and the flow will be turned off). Messages for the "SINK" protocol type are written to the file/device/stream indicated by the mgen "sink" command-line option. In the future, other protocol types will be available for MGEN traffic flows.</p><p>The optional UDP CONNECT attribute will direct MGEN to open a "connected" UDP socket. If the connection cannot be established or is not available for a time period, MGEN will continue to attempt to send packets until the flow is stopped. (Note that Windows and some Unix implementations may not always report IGMP port unreachable messages returned by the destination address when a socket is not listening to the requested port.)</p><p>Example:</p><p>This script line will originate a "flow" of MGEN UDP destined for the loopback address (IP address 127.0.0.1) port number 5000 beginning immediately when the script is executed. The messages will consist of 1024 byte messages at a regular rate of 1.0 per second:<code class="literal"></code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 PERIODIC [1.0 1024]</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_MOD_Event"></a>5.1.2.&nbsp;MOD Event</h4></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; MOD &lt;flowId&gt; [&lt;options ...&gt;]</code></p><p>This transmission event type is used to modify the characteristics of an existing flow identified by the &lt;flowId&gt; field. The given transmission event &lt;options&gt; determine which specific characteristics of the flow (e.g. PATTERN, TOS, destination (DST), connection status (CONNECT), broadcast, etc) will be affected. Multiple options may be specified in the script line. Note that the protocol type and source port number (SRC) cannot be changed with the MOD event type (the referenced flow should be terminated with an <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> event and re-initiated with an <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> event to accomplish this goal). If no &lt;options&gt;are given, the flow will remain unaltered. A script parse error will result if the identified flow was not previously initiated with an <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a>event.</p><p>Example:</p><p>This script line will modify "flow 1" to change it packet transmission pattern 5.0 seconds after script execution. The changed "flow 1" will then generate messages 512 bytes in size at an average rate of 10.0 messages per second following a Poisson (exponentially-distributed interval)<code class="literal"></code></p><p><code class="literal">5.0 MOD 1 POISSON [10.0 512]</code></p><p><code class="literal">Example:</code></p><p><code class="literal">These commands will connect a previously unconnected UDP socket. Note that the original socket will be closed and any pending queue for the flow will be cleared.</code></p><p><code class="literal">ON 1 UDP SRC 5000 DST 10.0.0.1/5001 PERIODIC [1 1024]</code></p><p><code class="literal">5.0 MOD 1 CONNECT </code></p><p><code class="literal">Example:</code></p><p><code class="literal">These commands will disconnect a previously connected socket and change the source port to 5001. To keep the socket connected you must also specify the CONNECT attribute on the MOD command.</code></p><p><code class="literal">ON 1 UDP CONNECT SRC 5000 DST 10.0.0.1/5001 PERIODIC [1 1024]</code></p><p><code class="literal">5.0 MOD 1 SRC 5001</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_OFF_Event"></a>5.1.3.&nbsp;OFF Event</h4></div></div></div><p>Script syntax:</p><p><code class="literal">&lt;eventTime&gt; OFF &lt;flowId&gt;</code></p><p>This transmission event type terminates message transmission for the flow identified by the &lt;flowId&gt; field at the time given in the &lt;eventTime&gt; field. There are no options applicable to this event type. A script parse error will result if the identified flow was not previously initiated with an <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> event.</p><p>Example:</p><p>This script line will terminate generation of MGEN message traffic for "flow 1" at 10.0 seconds after script execution.<code class="literal"></code></p><p><code class="literal">10.0 OFF 1</code></p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Transmission_Event_Options"></a>5.2.&nbsp;Transmission Event Options</h3></div></div></div><p>This section describes options which may be applied to <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> or <a class="link" href="#_MOD_Event" title="5.1.2.&nbsp;MOD Event">MOD</a>, transmission events in MGEN script files. Note that <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> event lines require specification of at least the &lt;protocol&gt;, &lt;destination&gt;, and &lt;pattern&gt; options, while only the options to be changed need to be specified as part of <a class="link" href="#_MOD_Event" title="5.1.2.&nbsp;MOD Event">MOD</a> event lines.</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Protocol__UDP_TCP_SINK"></a>5.2.1.&nbsp;Protocol (UDP/TCP/SINK)</h4></div></div></div><p>Option syntax:</p><p><code class="literal">... &lt;protocolType&gt; ...</code></p><p>The transport protocol for MGEN messages generated by a flow must be specified as part of any <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> events.</p><p>Example:</p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 PERIODIC [1.0 1024]</code></p><p><code class="literal">0.0 ON 2 TCP DST 127.0.0.1/5000 PERIODIC [1.0 1024]</code></p><p><code class="literal">0.0 ON 3 SINK DST 127.0.0.1/5000 PERIODIC [1.0 1024]</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Destination__DST"></a>5.2.2.&nbsp;Destination (DST)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... DST &lt;addr&gt;/&lt;port&gt; ...</code></p><p>The destination address for a flow must be specified for <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> events and may be altered as part of <a class="link" href="#_MOD_Event" title="5.1.2.&nbsp;MOD Event">MOD</a>, events. The &lt;addr&gt; field specifies the destination IP address (IPv4 or IPv6) and the &lt;port&gt; field specifies the destination host port number. The destination address may be a unicast (point-to-point) or multicast address.</p><p>Examples:<code class="literal"></code></p><p><code class="literal">#Start a flow to loopback address port 5000</code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 PERIODIC [1.0 1024]</code></p><p><code class="literal">#Modify flow 1 to a different destination port</code></p><p><code class="literal">0.0 MOD 1 DST 127.0.0.1/5001</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Source_Port_SRC"></a>5.2.3.&nbsp;Source Port (SRC)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... SRC &lt;port&gt; ...</code></p><p>The source port number used for generated traffic may be optionally specified as part of an <a class="link" href="#_ON_Event" title="5.1.1.&nbsp;ON Event">ON</a> event. The &lt;port&gt; field identifies the host port number to be used. When the SRC option is not specified or set to "0", the flow will use a free port number picked by the operating system. Note that MGEN UDP flows may share the same source port and the associated flow will "inherit" some attributes (e.g.<a class="link" href="#_Type-Of-Service_TOS" title="5.2.8.&nbsp;Type-Of-Service (TOS)">TOS</a>, <a class="link" href="#_Time-To-Live_TTL" title="5.2.9.&nbsp;Multicast/Unicast Time-To-Live (TTL)">TTL</a>, <a class="link" href="#_Broadcast" title="5.2.6.&nbsp;BROADCAST">BROADCAST</a> etc) which may have been set for other flows which use that same source port. This is because some of these attributes tend to be maintained by operating systems on a "per socket" basis. Also, any such attributes set for this flow will affect other existing flows using the same source port. Thus, the SRC option is useful when it is desired to explicitly create different flows with distinct "per socket" attributes such as <a class="link" href="#_Type-Of-Service_TOS" title="5.2.8.&nbsp;Type-Of-Service (TOS)">TOS</a> or <a class="link" href="#_Time-To-Live_TTL" title="5.2.9.&nbsp;Multicast/Unicast Time-To-Live (TTL)">TTL</a>.</p><p>NOTE: Under the windows operating system, the ability to reestablish TCP connections to a common SRC addr/port DST addr/port pair is limited by TCP's TIME_WAIT interval which can range from 2 minutes to 30 seconds. During this operating system dependent interval, any attempt to reuse the socket pair will fail. Allowing the operating system to provide the SRC port will allow connections to a common dst/port to be successful within this interval. This behavior may also manifest under certain Linux distributions as well.</p><p>Example:</p><p>Here, two flows are created with the same destination address, but different source ports. Flow 1 is also assigned non-default type-of-service using the TOS option. The use of the SRC option ensures that two different sockets are used to support the two different types of service.<code class="literal"></code></p><p><code class="literal">#Start flow 1 using source port 5001(TOS = 0x10) and flow 2 using port 5002</code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 SRC 5001 PERIODIC [1.0 1024] TOS 0x10</code></p><p><code class="literal">0.0 ON 2 UDP DST 127.0.0.1/5000 SRC 5002 PERIODIC [10.0 512]</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_COUNT"></a>5.2.4.&nbsp;<a class="link" href="#_COUNT" title="5.2.4.&nbsp;COUNT">COUNT</a></h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... COUNT &lt;msgCount&gt;[,off] ...</code></p><p>The optional COUNT attribute specifies the number of messages that are to be sent for the flow, e.g. a COUNT value of 1 means that one and only one mgen message will be sent. This attribute defaults to "-1", meaning mgen will send an unlimited number of messages until an <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> event occurs. If a message count is specified, the mgen flow will be paused after the requested number of messages has been sent. If the optional ",off" attribute is set the flow will be turned off after COUNT packets have been sent. The default behavior will keep the flow "alive" after COUNT packets have been sent and will be available for subsequent control.</p><p>Note that an <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> event will override any message COUNT specified (e.g. the flow will be terminated even if &lt;msgCount&gt; messages have not been sent) and that the <a class="link" href="#_QUEUE" title="6.10.&nbsp;QUEUE">QUEUE</a> attribute will override (defer) OFF events.</p><p>If a flow is paused (e.g. packet rate is set to 0) before the packet count as been reached, the initial message limit will still be in effect when the flow is resumed, e.g. in the following example 10 total packets will be sent.</p><pre class="programlisting">0.0 ON 1 UDP dst 127.0.0.1/5000 periodic [1 1024] count 10
# Pause flow
5.0 mod 1 periodic [0 1024]
# Resume flow
10.0 mod 1 periodic [1 1024]
60.0 off 1</pre><p>To ensure that the count is only applicable to the first transmission command, reset the count to -1 (unlimited messaging) or another count value:</p><pre class="programlisting">0.0 ON 1 UDP dst 127.0.0.1/5000 periodic [1 1024] count 10
# Pause flow 
5.0 mod 1 periodic [0 1024] 
# Resume flow with no message limit
10.0 mod 1 periodic [1 1024] COUNT -1
# Pause flow
15.0 mod 1 periodic [0 1024]
# Restart flow and send 5 packets
20.0 mod 1 periodic [1 1024] count 5
60.0 off 1</pre><p>Message counts are kept on a per flow basis regardless of how many flows are sharing a transport.</p><p>Given an input script with two gated flows, the mgen instance will exist after 8 packets have been sent:</p><pre class="programlisting">0.0 on 1 UDP dst 127.0.0.1/5000 periodic [1 1024] count 5,off

0.0 on 2 UDP dst 127.0.0.1/5000 periodic [1 1024] count 3,off</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Pattern__PER"></a>5.2.5.&nbsp;Pattern (PERIODIC, POISSON, BURST, JITTER, CLONE, &lt;sizeMin:sizeMax&gt;)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... &lt;patternType&gt; [parameters ...] ...</code></p><p>(Note: The '[' and ']' characters are explicitly required at the beginning and end of the pattern parameter set. Different pattern types may use different parameter sets.)</p><p>Traffic generated by MGEN consists of a series of sequence-numbered messages. The messaging generated by MGEN may vary in size and frequency of transmission to stress the network in a controlled fashion or possibly emulate other network applications. The "Pattern" of message generation must be specified in ON events and may be altered as part of subsequent <a class="link" href="#_MOD_Event" title="5.1.2.&nbsp;MOD Event">MOD</a>, events. Currently MGEN supports four pattern types, "PERIODIC", "POISSON", "BURST", "JITTER", and "CLONE". Complex traffic patterns can be created by using a compound of multiple "flows" (with the same SRC/DST) with different pattern types and parameters. Other pattern types (e.g. MARKOV), including ones with statistically varying payload sizes, will be added eventually.</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="PERIODIC_Pattern"></a>5.2.5.1.&nbsp;PERIODIC Pattern:</h5></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... PERIODIC [&lt;rate&gt; &lt;size&gt;]...</code></p><p>This pattern type generates messages of a fixed &lt;size&gt; (in bytes) at a very regular &lt;rate&gt; (in messages/second). For UDP protocol, the &lt;size&gt; field must be greater or equal to the minimum MGEN message size and less than or equal to the maximum UDP message size of 8192 bytes. For TCP protocol, &lt;size&gt; parameter is unlimited. Note the &lt;rate&gt; must be greater than or equal to 0.0 messages/second for the TCP and UDP protocols.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Start an MGEN flow sending 1024 byte messages</code></p><p><code class="literal">#at a rate of 10.0 per second</code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 PERIODIC [10.0 1024]</code></p><p><code class="literal">#Reduce the flow rate to one 512 byte message</code></p><p><code class="literal">#every 2.0 seconds</code></p><p><code class="literal">0.0 MOD 1 PERIODIC [0.5 512]</code></p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="POISSON_Pattern"></a>5.2.5.2.&nbsp;POISSON Pattern:</h5></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... POISSON [&lt;aveRate (msg/sec)&gt; &lt;size (bytes)&gt;] ...</code></p><p>This pattern type generates messages of a fixed &lt;size&gt; (in bytes) at statistically varying intervals at an average &lt;rate&gt; (in messages/second). For UDP protocol, the &lt;size&gt; field must be greater or equal to the minimum MGEN message size and less than or equal to the maximum UDP message size of 8192 bytes. For TCP protocol, &lt;size&gt; parameter is unlimited. Note the &lt;rate&gt; must be greater than or equal to 0.0 messages/second for the TCP and UDP protocols.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Start an MGEN flow sending 1024 byte messages</code></p><p><code class="literal">#at an average rate of 10.0 per second</code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 POISSON [10.0 1024]</code></p><p><code class="literal">#Reduce the flow rate to an average of one</code></p><p><code class="literal">#512 byte message every 2.0 seconds</code></p><p><code class="literal">0.0 MOD 1 POISSON [0.5 512]</code></p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="BURST_Pattern"></a>5.2.5.3.&nbsp;BURST Pattern:</h5></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... BURST [REGULAR|RANDOM &lt;aveInterval (sec)&gt; &lt;patternType&gt; [&lt;patternParams&gt;] FIXED|EXPONENTIAL &lt;aveDuration (sec)&gt;] ...</code></p><p>The BURST pattern generates bursts of other MGEN pattern types at a specified average interval. The first parameter of the BURST pattern is either "REGULAR" resulting in periodic burst uniformly distributed in time by the &lt;aveInterval&gt; value, or "RANDOM" which exponentially distributes the traffic generation bursts in time with an average burst interval as specified by the &lt;aveInterval&gt; parameter value. The characteristics of the MGEN messages generated during a burst is given by the &lt;patternType&gt; and associated &lt;patternParams&gt; parameters. The &lt;patternType&gt; may any MGEN pattern type including PERIODIC, POISSON, or, yes, even BURST. The &lt;patternParams&gt; must be appropriate for the given &lt;patternType&gt;. When a traffic generation burst occurs, its duration is either of a FIXED value as given by the &lt;aveDuration&gt; or a randomly varying duration with EXPONENTIAL statistics and an average duration as given by the &lt;aveDuration&gt; parameter.</p><p>An example use of the BURST pattern would be to roughly emulate the "talk spurts" which might result from Voice Over IP (VOIP) applications. As a voice conversation commences, a user's burst of activity (talk spurts) might be RANDOM with some average interval and the duration talk spurts approximate EXPONENTIAL statistics. &gt; When the talk spurt (burst) occurs, the voice compression codec might generate messages following something like a PERIODIC flow with packet rates and packet sizes dependent upon the voice codec in use.</p><p>Other uses of the BURST pattern might be to roughly model message/packet generation occurring with random use of a network such as web browsing, etc. The BURST model provided by MGEN does not presuppose any specific traffic model, but might be useful in approximating some models of regular or intermittent network activity.</p><p>The average traffic generation rate for this pattern should be approximately the average transmission rate of the core &lt;patternType&gt; and &lt;patternParams&gt; multiplied by the burst duty cycle (&lt;aveDuration&gt; / &lt;aveInterval&gt;). Note that when average burst duration tends to exceed the average burst interval, the flow will tend to follow the characteristics of the core pattern (i.e. 100% duty cycle).</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Start a bursty MGEN flow with bursts of 1024 byte messages</code></p><p><code class="literal">#with a periodic rate of 10.0 messages per second. The</code></p><p><code class="literal">#bursts will occur at random intervals with an average</code></p><p><code class="literal">#interval from the start of one burst until the start of</code></p><p><code class="literal">#the next of 10.0 seconds. The duration of each burst is</code></p><p><code class="literal">#of exponential statistics with an average burst duration</code></p><p><code class="literal">#of 5.0 seconds.</code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 BURST [RANDOM 10.0 PERIODIC [10.0 1024] EXP 5.0]</code></p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="JITTER_Pattern"></a>5.2.5.4.&nbsp;JITTER Pattern:</h5></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... JITTER [&lt;rate&gt; &lt;size&gt; &lt;jitterFraction&gt;]...</code></p><p>This pattern type generates messages of a fixed &lt;size&gt; (in bytes) with the specified jitter pattern defined by the &lt;rate&gt; (in messages/second) and &lt;jitterFraction&gt;. The jitterFraction defines the interval of deviation from the rate and must be greater than zero and less than 0.5. A jitter pattern of "JITTER [1 1024 .5]" will result in packets being sent at a random interval between 0.5 seconds and 1.5 seconds. For the UDP protocol the &lt;size&gt; field must be greater or equal to the minimum MGEN message size and less than or equal to the maximum UDP message size of 8192 bytes. For TCP protocol, &lt;size&gt; parameter is unlimited. Note the &lt;rate&gt; must be greater than or equal to 0.0 messages/second for the TCP and UDP protocols.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Start an MGEN flow sending 1024 byte messages</code></p><p><code class="literal">#at a random interval between 0.5 and 1.5 seconds.</code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 JITTER [1.0 1024 .5]</code></p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="CLONE_Pattern"></a>5.2.5.5.&nbsp;CLONE Pattern:</h5></div></div></div><p>Option syntax:</p><p><code class="literal">... CLONE [&lt;fileType&gt; &lt;fileName&gt; [&lt;repeatCount&gt;]]...</code></p><p>This pattern type will incrementally read a file of the specified &lt;fileType&gt; to determine mgen packet sizes and message transmission intervals. Currently only tcpdump binary files are supported. It is assumed that the tcpdump file has been filtered to contain only the traffic that is to be "cloned".</p><p>At the flow event start time mgen will send a packet corresponding to the size of the first packet read from the file. Note that mgen assumes the records contain IPv4 UDP headers and therefore subtracts 42 bytes from the captured frame size reported by tcpdump. The second packet will be read from the file and a the second mgen packet of the same size will be sent as scheduled by the interval between the first and second packets. When the file is rewound, the first packet will not be transmitted. The second packet in the file will be scheduled to be sent after the last packet in the file according to the interval between the first and second packets in the file.</p><p>At present the only valid &lt;fileType&gt; is "tcpdump". The tcpdump file must be in binary format (created with tcpdump's -w option) and is assumed to be filtered to contain only the traffic that is to be cloned.</p><p>&lt;fileName&gt; is the name of the file containing the data to be used as the template for the MGEN pattern timing (packet intervals) and packet size(s).</p><p>&lt;repeatCount&gt; is an optional parameter that specifies the number of times the file is to be processed. &lt;repeatCount&gt; can be set to "-1" (the default), "0", or a positive integer. "-1" causes the file to be continuously read until the flow is stopped by an OFF event or the mgen program ends. "0" directs mgen to clone the file once and stop. A positive integer "N" indicates the number of repititions through the file, e.g. a value of 1 will cause the file to be read twice, once plus the repeat.</p><p>Out of sequence time stamps have been seen occasionally in tcpdump output. MGEN will schedule these packets for immediate transmission and if running at debug level 2, will log a warning message.</p><p>Note that some Linux distributions enable "segmentation/reassembly offload". This feature causes the network driver to do TCP segmentation and reassembly. In such case, larger packets than MGEN can clone will be logged in the pcap files. Disable this feature to successfully process this data. (e.g. ethtool --offload eth0 gso off; ethtool --offload eth0 tso off; ethtool --offload eth0 gro off).</p><p>Example:</p><p><code class="literal">#Start an MGEN flow and clone the contents of the specified file once</code></p><p>0<code class="literal">.0 ON 1 UDP DST 127.0.0.1/5000 CLONE [tcpdump tcpdump.dat [0]]</code></p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a name="CLONE_Pattern"></a>5.2.5.6.&nbsp;Uniform random message size:</h5></div></div></div><p>Option syntax:</p><p><code class="literal">... &lt;patternType&gt; [&lt;rate&gt; &lt;sizeMin:sizeMax&gt;]...</code></p><p>Setting a message size range will send uniformly random message sizes within the range sizeMin to sizeMax. The minimum &lt;sizeMin&gt; must be as big as the minimum allowed message size.</p><p>Example:</p><p><code class="literal">#Start an MGEN flow and one message per second, uniformaly random in size from 824 bytes</code></p><p># to 1224 bytes (e.g. 1024 byes average).</p><p>0<code class="literal">.0 ON 1 UDP DST 127.0.0.1/5000 PERIODIC [1 824:1224]</code></p></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Broadcast"></a>5.2.6.&nbsp;BROADCAST</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... BROADCAST {ON|OFF} ...</code></p><p>This sets the SO_BROADCAST socket option to enable or disable the sending (and sometimes receiving) of broadcast messages. By default BROADCAST is ON.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Logdata"></a>5.2.7.&nbsp;LOGDATA</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... LOGDATA {ON|OFF} ...</code></p><p>Controls whether MGEN will log the optional data attribute field at MGEN receivers (including within MGEN binary log files). It does not affect whether MGEN senders send the requested data attribute. By default LOGDATA is ON.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Type-Of-Service_TOS"></a>5.2.8.&nbsp;Type-Of-Service (TOS)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... TOS &lt;value&gt; ...</code></p><p>The IP TOS (type-of-service) field can be controlled for IP packets associated with MGEN traffic generation. The &lt;value&gt; field specifies the value of the 8-bit TOS field in IPv4 packets. (IPv6 packets do not have a TOS field. MGEN will soon support control of the similar FLOW_ID field for IPv6 operation.) The &lt;value&gt; field must be in the range of 0-255 in decimal or hexadecimal notation. The interpretation of the TOS value by different computer operating systems and network devices may vary. In some cases, computer hosts will not allow all possible values to be used, and in others "super user" (root) privileges may be required to set the IP TOS field to certain values. Below are some notes on suggested interpretation by the Internet Engineering Task Force (IETF). Note that TOS is maintained on a "per socket" basis and that setting the TOS for a flow will affect other flows sharing the same network socket. See the <a class="link" href="#_Source_Port_SRC" title="5.2.3.&nbsp;Source Port (SRC)">SRC</a> option to make sure different flows use different sockets.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Start flow 1 with default TOS</code></p><p><code class="literal">0.0 ON 1 UDP DST 127.0.0.1/5000 PERIODIC [1.0 1024]</code></p><p><code class="literal">#Modify flow 1 to TOS = 0x10 (low delay)</code></p><p><code class="literal">5.0 MOD 1 TOS 0x10</code></p><p>Notes on the value of the IP TOS field:</p><pre class="programlisting">    
	
  0     1     2     3     4     5     6     7   
+-----+-----+-----+-----+-----+-----+-----+-----+
|   PRECEDENCE    |          TOS          | MBZ |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre><p>The Type-of-Service byte in the IP header is divided into three sections: the Precedence field (high-order 3 bits), a field that is called Type of Service or TOS (next 4 bits), and a reserved bit (the low order bit). The TOS bits can be set to 5 different settings including the default setting of 0000, while the PRECEDENCE can be set to 8 different setting including default 000.</p><p>TOS definitions:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><tbody><tr><td>&nbsp;</td><td>IPTOS_TOS_MASKIPTOS_TOS(tos)</td><td>0x1E= ((tos) &amp; IPTOS_TOS_MASK)</td><td class="auto-generated">&nbsp;</td></tr><tr><td>1000 --</td><td>IP_TOS_LOWDELAY</td><td>0x10</td><td>TOS = 16</td></tr><tr><td>0100 --</td><td>IP_TOS_THROUGHPUT</td><td>0x08</td><td>TOS = 8</td></tr><tr><td>0010 --</td><td>IPTOS_RELIABILITY</td><td>0x04</td><td>TOS = 4</td></tr><tr><td>0001 --</td><td>IPTOS_LOWCOST</td><td>0x02</td><td>TOS = 2</td></tr><tr><td>0000 --</td><td>normal service</td><td>0x00</td><td>TOS = 0</td></tr></tbody></table></div><p>Precedence definitions:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><tbody><tr><td>111 --</td><td>IPTOS_PREC_MASKIPTOS_PREC(tos)</td><td>0xe0= ((tos) &amp;IPTOS_PREC_MASK)</td><td class="auto-generated">&nbsp;</td></tr><tr><td>111 --</td><td>IPTOS_PREC_NETCONTROL</td><td>0xe0</td><td>TOS = 224</td></tr><tr><td>110 --</td><td>IPTOS_PREC_INTERNETCONTROL</td><td>0xc0</td><td>TOS = 192</td></tr><tr><td>101 --</td><td>IPTOS_PREC_CRITIC_ECP</td><td>0xa0</td><td>TOS = 160</td></tr><tr><td>100 --</td><td>IPTOS_PREC_FLASHOVERRIDE</td><td>0x80</td><td>TOS = 128</td></tr><tr><td>011 --</td><td>IPTOS_PREC_FLASH</td><td>0x60</td><td>TOS = 96</td></tr><tr><td>010 --</td><td>IPTOS_PREC_IMMEDIATE</td><td>0x40</td><td>TOS = 64</td></tr><tr><td>001 --</td><td>IPTOS_PREC_PRIORITY</td><td>0x20</td><td>TOS = 32</td></tr><tr><td>000 --</td><td>IPTOS_PREC_ROUTINE</td><td>0x00</td><td>TOS = 0</td></tr></tbody></table></div><p>If <code class="literal">TOS = 164 (or 0xa4)</code>, the Precedence would be <code class="literal">IPTOS_PREC_CRITIC_ECP</code> and the <code class="literal">TOS</code> would be <code class="literal">IPTOS_RELIABILITY</code>. The <code class="literal">IP TOS</code> field bits would be set as <code class="literal">10100100</code>.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_Time-To-Live_TTL"></a>5.2.9.&nbsp;Multicast/Unicast Time-To-Live (TTL)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... TTL &lt;value&gt; ...</code></p><p>The time-to-live (TTL) hop count can be controlled for IP multicast traffic or Ip unicast traffic (as defined by the dstAddr) generated by MGEN. As with <a class="link" href="#_Type-Of-Service_TOS" title="5.2.8.&nbsp;Type-Of-Service (TOS)">TOS</a>, this is generally a "per socket" attribute and care should be taken if it is desired to specify different TTL values for different MGEN flows. This can be accomplished by using different <a class="link" href="#_Source_Port_SRC" title="5.2.3.&nbsp;Source Port (SRC)">SRC</a> (source ports) for different MGEN flows. The &lt;value&gt; field must be in the range of 1-255. The default multicast TTL assumed by MGEN is 1. The default unicast TTL assumed by MGEN is 255.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Start an IP multicast flow with a maximum multicast hop count ttl = 2</code></p><p><code class="literal">0.0 ON 1 UDP DST 224.1.2.3/5000 PERIODIC [1.0 256] TTL 2</code></p><p><code class="literal">#Start an IP unicast flow with a maximum unicast hop count ttl = 2</code></p><p><code class="literal">0.0 ON 1 UDP DST 10.0.0.1/5000 PERIODIC [1.0 256] TTL 2</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_IPv6_Flow_Label"></a>5.2.10.&nbsp;Socket Transmit Buffer Size (TXBUFFER)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... TXBUFFER &lt;txBufferSize&gt; ...</code></p><p>This option allows users to set the socket transmit buffer size to a value at least as large as &lt;txBufferSize&gt;. If &lt;txBufferSize&gt; is larger that the maximum allowed by the system, &lt;txBufferSize&gt; will be set to the system maximum. To date, this option has only been tested on <span class="emphasis"><em>linux</em></span> systems.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Socket_Receive_Buffer_Size__RXBUFFER"></a>5.2.11.&nbsp;Socket Receive Buffer Size (RXBUFFER)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... RXBUFFER &lt;rxBufferSize&gt; ...</code></p><p>This option allows users to set the socket receive buffer size to a value at least as large as &lt;rxBufferSize&gt;. If &lt;rxBufferSize&gt; is larger that the maximum allowed by the system, &lt;rxBufferSize&gt; will be set to the system maximum. To date, this option has only been tested on <span class="emphasis"><em>linux</em></span> systems.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="IPv6_Flow_Label__LABEL"></a>5.2.12.&nbsp;IPv6 Flow Label (LABEL)</h4></div></div></div><p>Option syntax:<code class="literal"></code></p><p><code class="literal">... label &lt;value&gt; ...</code></p><p>This option allows users to specify the value applied to the IPv6 packet header "flow label" field. Although this field is 28 bits, different operating systems may restrict which portions of the field may be set. For example, the current Linux kernel (circa Jan 2003) only allows bits in the first octet of the flow label to be set. Other values are invalid on Linux, and generate an error message. Thus, using hexadecimal format for the &lt;value&gt; specified, legal values for Linux are restricted to <code class="literal">&lt;value&gt; = 0x0??00000</code> where "??" specifies the first octet of the flow label. Other operating systems may behave differently.</p><p>Example:<code class="literal"></code></p><p><code class="literal"># Start an IPv6 flow with flow label = 0x03d00000</code></p><p><code class="literal">0.0 ON 1 UDP LABEL 0x03d00000 SRC 5000 DST5f1b:df00:ce3e:e200:0800:2078:e3e3/5001 PERIODIC [1 1024]</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Multicast_Interface__INTERFACE"></a>5.2.13.&nbsp;Multicast Interface (INTERFACE)</h4></div></div></div><p>Option syntax:<code class="literal">... INTERFACE &lt;interfaceName&gt; ...</code></p><p>The network interface to use for IP multicast flow transmission can be controlled with this option. The &lt;interfaceName&gt; is the network interface device name to be used for IP multicast transmission for the associated flow. Again, as with <a class="link" href="#_Type-Of-Service_TOS" title="5.2.8.&nbsp;Type-Of-Service (TOS)">TOS</a> and <a class="link" href="#_Time-To-Live_TTL" title="5.2.9.&nbsp;Multicast/Unicast Time-To-Live (TTL)">TTL</a>, this is generally a "per socket" attribute and care should be taken if it is desired to specify different multicast interfaces for different MGEN flows. This can be accomplished by using different <a class="link" href="#_Source_Port_SRC" title="5.2.3.&nbsp;Source Port (SRC)">SRC</a> (source ports) for different MGEN flows. If no INTERFACE option is used, MGEN will behave according to the operating system's default behavior.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Start an IP multicast flow on Ethernet interface named "eth1"</code></p><p><code class="literal">0.0 ON 1 UDP DST 224.1.2.3/5000 PERIODIC [1.0 256] INTERFACE eth1 SRC 5001</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="Sequence_Number_Initialization__SEQUENCE"></a>5.2.14.&nbsp;Sequence Number Initialization (SEQUENCE)</h4></div></div></div><p>Option syntax: <code class="literal"></code></p><p><code class="literal">... SEQUENCE &lt;sequenceNumber&gt; ...</code></p><p>This option sets the sequence number of the next message transmitted for the flow. MGEN flows are normally initialized to a sequence number of zero upon the first "ON" event for the flow. The sequence number is incremented by one with each message transmitted. The SEQUENCE option allows the user to override this behavior. It (along with the OFFSET command) is used by the SAVE command with MOD events for pending flows when it is desired that mgen return to a particular point in a script after being stopped and restarted.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Modify the sequence number of an existing flow such that</code></p><p><code class="literal">#the next message is transmitted with sequence number 452.</code></p><p><code class="literal">12.0 MOD 1 SEQUENCE 452</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1437"></a>5.2.15.&nbsp;UDP Connect (CONNECT)</h4></div></div></div><p>Option syntax:</p><p>... CONNECT ...</p><p>The optional UDP CONNECT attribute will direct MGEN to open a "connected" UDP socket. If the connection cannot be established or is not available for a time period, MGEN will continue to attempt to send packets until the flow is stopped.</p><p>Example:</p><p><code class="literal">#Open up a CONNECTED UDP socket</code></p><p><code class="literal">1.0 ON 1 UDP CONNECT DST 10.0.0.1/500 PER [1 1024]</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="d0e1454"></a>5.2.16.&nbsp;DF (fragmentation bit)</h4></div></div></div><p>Option syntax:</p><p>... DF {ON|OFF} ...</p><p>The optional DF command controls whether the df fragmentation bit is set for the flow.</p><p>Example:</p><p><code class="literal">#Set fragmentation bit</code></p><p><code class="literal">1.0 ON 1 UDP DST 10.0.0.1/500 PER [1 1024] DF ON</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_FLOW_REPORT"></a>5.2.17.&nbsp;REPORT</h4></div></div></div><p>Option syntax:</p><p>... REPORT ...</p><p>Instructs the flow to include per-flow analytic reports in its transmitted MGEN message payload. MGEN nodes that receive these "report" payloads will log REPORT events in their log files in addition to RECV events if the analytics global has been set at the receiving node. The reporting is "in-band" of scripted message generation. The typical size of a per-flow report is 24-28 bytes but is "hidden" in the normally "dummy" payload content of MGEN messages so it doesn't really add overhead. The metrics reported are efficiently quantized to enable the compact reports and that enables reporting potentially on many received flows in a single transmitted MGEN message.</p><p>The "in-band" reports are subject to the message size and rate limits of the transmitting flow(s). A round-robin scheme, with precedence to unreported and active flows, is used to populate the message payload content with reports to provide assurance of delivery of relevant report. Note that reports are sent redundantly when possible when the message rate is sufficiently high. This provides some assurance of report delivery even with message loss. Post-processing of log files will require filtering of the redundant REPORT lines logged.</p><p>An example flow command that enables this analytic reporting is:</p><p><code class="literal">mgen event "ON 1 UDP DST 127.0.0.1/5000 PER [1 1024] report" window 10.0</code></p><p>Here an MGEN message with report content for any analytics for flows received by that MGEN node would be sent once per second. The report content would be updated once per 10 seconds but the receiver(s) of this reporting flow would still log a report once per second. Of course, an MGEN node receiving nothing will have nothing to report unless it has received prior flows. The REPORT "offset" will become "stale" (a large value) for flows that have become inactive.</p><p>Locally generated REPORT events can be distinguished by a 0.0 offset&gt; value and have the format:</p><pre class="programlisting">01:17:01.983235 REPORT proto&gt;UDP flow&gt;3 src&gt;127.0.0.1/63684 dst&gt;127.0.0.1/5002 offset&gt;0.000000 window&gt;1.970563 rate&gt;10.000000 kbps loss&gt;0.000000 latency ave&gt;0.000119 min&gt;0.000109 max&gt;0.000129
</pre><p>REPORT events from remote nodes include "sent&gt;" timestamp:</p><pre class="programlisting">01:17:01.983235 REPORT proto&gt;UDP flow&gt;3 src&gt;127.0.0.1/63684 dst&gt;127.0.0.1/5002 sent&gt;01:16.58.675309 offset&gt;0.023000 window&gt;1.970563 rate&gt;10.000000 kbps loss&gt;0.000000 latency ave&gt;0.000119 min&gt;0.000109 max&gt;0.000129</pre><p>The interpretation of the "sent&gt;" field and the "offset&gt;" fields is the reported analytics measurement window, <span class="emphasis"><em>End</em></span> time is "sentTime - offset". The "offset" is a quantized delay time (in seconds) from the time the included analytics were computed (at window end) until they were included in the MGEN message payload sent by the remote node.</p><p>When filtering duplicate REPORT items in a log file containing REPORTs received from remote nodes, the filtering algorithm should favor the REPORT event (among duplicates) that has the smallest "offset" value. The quantization algorithm used to generate compact reports yields more precision for small "offset" values as compared to large "offset" values.</p><p>The usual time synchronization requirements for latency measurement validity still stand, but it should be noted that the latency "max/min" can be used to assess flow message delivery "jitter" regardless of the validity of the absolute average latency measurement.</p><p>There is also a global "report" command that can be used to make all transmitting flows include the analytic reports by default, but thought should be given to what reporting is required (i.e., a single flow can report for all received flows and multiple reporting flows will be redundant even though this reporting is "in-band" of scripted message generation).</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_SUSPEND"></a>5.2.18.&nbsp;SUSPEND</h4></div></div></div><p>Option syntax:</p><p>... SUSPEND &lt;flowId(s)|range&gt; ...</p><p>Uses in-band MGEN message payload content to suspend <span class="emphasis"><em>remote</em></span> MGEN flows matching the given flow id, comma separated list of flow id(s), or flow id range.</p><p>Example Usage:</p><p><code class="literal">mgen event "ON 1 UDP DST 127.0.0.1/5000 PER [1 1024] suspend 1,3-5"</code></p><p>Typically, it is expected that this command be used to manage remote flows that were specified with a "count" limit option, but this is not a requirement. Currently, the remote controlled flows configured MUST have flowId values in the range of 1-40. (This could be expanded with a minor update to the source code if a larger number of flowId values need to be managed). Here is an example scenario:</p><p>Remote MGEN (listening on port 5001 and sending to destination port 5002):</p><pre class="programlisting">mgen event "listen udp 5001" event "on 1 udp dst 127.0.0.1/5002 per [1 1250]"</pre><p>Local MGEN (listening on port 5002 and sending to destination port 5001):</p><pre class="programlisting">mgen event "listen udp 5002" event "on 1 udp dst 127.0.0.1/5001 per [1 1250]"</pre><p>At this point both the "remote" and "local" MGEN instances will be sending their flows and receiving from one another. As an example, the "local" MGEN can command the remote to suspend transmission of its flow '1' using:</p><pre class="programlisting">mgen event "listen udp 5002" event "on 1 udp dst 127.0.0.1/5001 per [1 1250] suspend 1"</pre><p>Note that these suspend/resume/reset flow options can have comma-delimited ranges of flowId values so the following examples are valid:</p><pre class="programlisting">mgen event "on 1 udp dst 127.0.0.1/5001 per [1 1250] suspend 1-3,5,8-11</pre><p>Also, multiple options can be specified. For example:</p><pre class="programlisting">mgen event "on 1 udp dst 127.0.0.1/5001 per [1 1250] suspend 2,4, resume 5"</pre><p>The "suspend" and "resume" options simply pause and resume flow transmission, respectively. The "reset" command can be used to act as a "keep-alive" for remote flows that have the "count" option set. When a "reset" command is received, the sender flow message counter is reset so the flow will continue transmitting for as long as "reset" commands are actively received. When "reset" reception stops, the count-limited flow will end transmission once its count decrements to zero per usual.</p><p>The use of the "reset" command can act as a "safe", fault-tolerant mechanism so that a remote MGEN will automatically terminate its transmission when messages are no longer received from the local MGEN controller. Thus, if a network become congested, etc., the transmissions will halt. Similarly, in wireless networks, transmissions by the remote would eventually cease when out of communications range, but then resume once back in range and once again actively receiving the "reset" commands from the controller. Note that remote flows that don't have a "count" limit will <span class="emphasis"><em>not</em></span> expire and the "suspend" option must be used to pause those.</p><p>Care should be taken to have a single controller managing a remote MGEN. Note that multicast flow commands can be sent as well, but again, care should be taken. TCP flows could even bue used for the commands and reporting if desired.</p><p>The "reserver" field in the MGEN message format (byte prior to the "payload_length" field is now used as a "payload_type" to indicate whether the payload is MGEN_DATA or USER_DATA (i.e. user-defined content). When the "<a class="link" href="#_FLOW_REPORT" title="5.2.17.&nbsp;REPORT">report</a>" flow is set, this supersedes any user-defined payload content set for the flow. Hence, if one is also using user-defined payloads, one should be judicious in which flows are configured with the "report" option. Both analytic <a class="link" href="#_FLOW_REPORT" title="5.2.17.&nbsp;REPORT">report </a> content and remote flow command content can be carried in the MGEN_DATA payload type. Supported report and command content may be extended over time.</p><p>HINT: MGEN "mod" events can be used to dynamically control these features. For example, the averaging "<a class="link" href="#_WINDOW" title="6.23.&nbsp;WINDOW">window</a>" can be changed on the fly, etc. as well as dynamic use of the "suspend", "resume", and "reset" remote control commands as desired.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_RESUME"></a>5.2.19.&nbsp;<a class="link" href="#_RESUME" title="5.2.19.&nbsp;RESUME">RESUME</a></h4></div></div></div><p>Option syntax:</p><p>... RESUME &lt;flowId(s)|range&gt; ...</p><p>Uses in-band MGEN message payload content to resume <span class="emphasis"><em>remote</em></span> MGEN flows matching the given flow id, comma separated list of flow id(s), or flow id range.</p><p>For example:</p><p><code class="literal">mgen event "ON 1 UDP DST 127.0.0.1/5000 PER [1 1024] resume 1-3,5,8-11"</code></p><p>Typically, it is expected that this command be used to manage remote flows that were specified with a "count" limit option, but this is not a requirement. Currently, the remote controlled flows configured MUST have flowId values in the range of 1-40. (This could be expanded with a minor update to the source code if a larger number of flowId values need to be managed). See <a class="link" href="#_SUSPEND" title="5.2.18.&nbsp;SUSPEND">SUSPEND</a> for usage examples.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_RESET"></a>5.2.20.&nbsp;<a class="link" href="#_RESET" title="5.2.20.&nbsp;RESET">RESET</a></h4></div></div></div><p>Option syntax:</p><p>... RESET &lt;flowId(s)|range&gt; ...</p><p>Uses in-band MGEN message payload content to reset <span class="emphasis"><em>remote</em></span> MGEN flows matching the given flow id, comma separated list of flow id(s), or flow id range.</p><p>For example:</p><p><code class="literal">mgen event "ON 1 UDP DST 127.0.0.1/5000 PER [1 1024] reset 1-3,5,8-11"</code></p><p>The "reset" command can be used to act as a keep-alive for remote flows that have the <a class="link" href="#_COUNT" title="5.2.4.&nbsp;COUNT">COUNT</a> option set. When a "reset" command is received, the sender flow message counter is reset so the flow will continue transmitting for as long as "reset" commands are actively received. When "reset" reception stops, the count limited flow will end transmission once its count decrements to zero per usual. Note that the sequence number for the remote flow is <span class="emphasis"><em>not</em></span> reset.</p><p>The use of the "reset" command can act as a "safe", fault-tolerant mechanism so that a remote MGEN will automatically terminate its transmission when messages are no longer received from the local MGEN controller. Thus if a network becomes congested, etc., the transmissions will halt. Similarly, in wireless networks, transmissions by the remote would eventually cease when out of communications range, but then resume once back in range and once again actively receiving the "reset" commands from the controller. Note that remote flows that don't have a "count" limit will <span class="emphasis"><em>not</em></span> expire and the "suspend" option must be used to pause these.</p><p>Currently, the remote controlled flows configured MUST have flowId values in the range of 1-40. (This could be expanded with a minor update to the source code if a larger number of flowId values need to be managed). See <a class="link" href="#_SUSPEND" title="5.2.18.&nbsp;SUSPEND">SUSPEND</a> for an example scenario.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_RESET"></a>5.2.21.&nbsp;<a class="link" href="#">RETRY</a></h4></div></div></div><p>Option syntax:</p><p>... RETRY &lt;count&gt;[|&lt;delay&gt;] ...</p><p>If the underlying TCP socket for the flow fails to connect, or disconnects, attempt to reconnect the socket &lt;count&gt; times after &lt;delay&gt; seconds. The default retry interval is 5 seconds. The transport will attempt to reconnect over the life of the flow if the retry count is set to -1. If multiple flows are sharing the transport a common retry pattern should be used by all the flows or the last attribute set "wins".</p><p>For example:</p><p>Attempt to connect every five seconds:</p><pre class="programlisting">ON 1 TCP DST 127.0.0.1/5000 PERIODIC [1 1024] RETRY -1/5 </pre><p>Attempt to connect twice after initial failure every 3 seconds</p><pre class="programlisting">ON 1 TCP DST 127.0.0.1/5000 PERIODIC [1 1024] RETRY 2/3 </pre><p>RECONNECT events are logged at each reconnect attempt:</p><pre class="programlisting">17:36:12.762619 RECONNECT flow&gt;1 srcPort&gt;35859 dst&gt;127.0.0.1/5000 
17:36:17.763483 RECONNECT flow&gt;1 srcPort&gt;46864 dst&gt;127.0.0.1/5000 
17:36:22.764783 RECONNECT flow&gt;1 srcPort&gt;46866 dst&gt;127.0.0.1/5000 </pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Reception_Events"></a>5.3.&nbsp;Reception Events</h3></div></div></div><p>For simple reception and logging of unicast traffic, it is generally sufficient just to launch mgen with the <span class="emphasis"><em>port</em></span> command line option specifying the port numbers to monitor. However, for IP multicast operation or more complex behavior, an MGEN script with "Reception Events" is required.; "Reception Events" in the MGEN script file format include <a class="link" href="#_LISTEN" title="5.3.1.&nbsp;LISTEN">LISTEN</a> and <a class="link" href="#_IGNORE" title="5.3.2.&nbsp;IGNORE">IGNORE</a> types to control which ports are being monitored when; and <a class="link" href="#_JOIN" title="5.3.3.&nbsp;JOIN">JOIN</a> and <a class="link" href="#_LEAVE" title="5.3.4.&nbsp;LEAVE">LEAVE</a> types to dynamically control IP group membership. The MGEN script syntax of "Reception Events" is:</p><p><code class="literal">&lt;eventTime&gt; &lt;eventType&gt; &lt;parameters ...&gt; [&lt;options ...&gt;]</code></p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_LISTEN"></a>5.3.1.&nbsp;LISTEN</h4></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; LISTEN &lt;protocol&gt; &lt;portList&gt;</code></p><p>The LISTEN event is used to prompt mgen to begin monitoring one or more ports for received traffic. The &lt;eventTime&gt; denotes the time (in seconds) relative to script execution. The &lt;protocol&gt; field specifies the transport protocol type. Currently, "UDP" and "TCP" transports are supported. The &lt;portList&gt; field is a comma-delimited list of individual or inclusive ranges of the port numbers (no spaces allowed) to begin monitoring. Port ranges within the list are specified in the format "&lt;lowValue&gt;-&lt;hiValue&gt;".</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Monitor UDP port numbers 5000, 5003, 5004, 5005, 5009</code></p><p><code class="literal">#and TCP port number 6000, 6003, 6004, 6005</code></p><p><code class="literal">#beginning at time 0.0</code></p><p><code class="literal">0.0 LISTEN UDP 5000,5003-5005,5009</code></p><p><code class="literal">0.0 LISTEN TCP 6000,6003-6005</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_IGNORE"></a>5.3.2.&nbsp;IGNORE</h4></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; IGNORE &lt;protocol&gt; &lt;portList&gt;</code></p><p>The IGNORE event type is the converse to the <a class="link" href="#_LISTEN" title="5.3.1.&nbsp;LISTEN">LISTEN</a> event type. An IGNORE event causes mgen tostop monitoring (and logging) received traffic on the specified &lt;portList&gt;. The &lt;eventTime&gt; denotes the time (in seconds) relative to script execution. The &lt;protocol&gt; field specifies the transport protocol type. "UDP" and "TCP" transports are supported. The &lt;portList&gt; field is a comma-delimited list of individual or inclusive ranges of the port numbers (no spaces allowed) to begin monitoring. Port ranges within the list are specified in the format <code class="literal">"&lt;lowValue&gt;-&lt;hiValue&gt;".</code></p><p>Example:<code class="literal"></code></p><p><code class="literal">#Stop monitoring UDP port numbers 5003, 5004, 5005, 5009</code></p><p><code class="literal">#and TCP port numbers 6003, 6004, 6005</code></p><p><code class="literal">#beginning at time 10.0</code></p><p><code class="literal">10.0 IGNORE UDP 5003-5005,5009</code></p><p><code class="literal">10.0 IGNORE TCP 6003-6005</code></p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_JOIN"></a>5.3.3.&nbsp;JOIN</h4></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; JOIN &lt;groupAddress&gt; [SRC &lt;srcAddress&gt;] [INTERFACE &lt;interfaceName&gt;] [PORT &lt;portNumber| portList&gt;]</code></p><p>The JOIN event is used to prompt mgen to "join" the specific IP multicast group indicated by the &lt;groupAddress&gt; field. The SRC option can be used to join a source specific multicast (SSM) channel. Note that the SRC option is not presently available on windows. The INTERFACE option forces the membership join request on the network interface identified by the &lt;interfaceName&gt; field. If no INTERFACE option is given, the operating system's default behavior is observed. Note it is possible to join the same group on multiple, different interfaces.</p><p>The PORT option should be used on WIN32 systems where the IP multicast join must be performed on the same socket bound to a specific &lt;portNumber&gt;.</p><p>Unix-based operating systems generally allow for IP multicast group membership to be independent of specific socket port bindings. Note that a corresponding <a class="link" href="#_LISTEN" title="5.3.1.&nbsp;LISTEN">LISTEN</a> event for the indicated &lt;portNumber&gt; is required in order to receive traffic if not set as a JOIN command option. Specify the PORT option as a JOIN command option if your Unix based system does not support port binding independence.</p><p>Not that on IPv6 systems (and when mgen is compiled with the HAVE_IPV6 compile option) the JOIN port option must be specified when joining an IPv4 group.</p><p>On OSX systems, the interface option must be used if a default multicast route is not defined on the system.</p><p>As many IP group memberships as the operating system will support is permitted by mgen. This is generally a limit of the maximum number of open sockets per process or in the system at large if multiple mgen instances are used. Note that WIN32 imposes a limitation of one IP multicast group membership per socket while Unix-based systems can allow for many memberships (often 20, but OS-specific) per socket.</p><p>Examples:<code class="literal"></code></p><p><code class="literal">#JOIN group 224.1.2.3 at time 0.0</code></p><p><code class="literal">0.0 JOIN 224.1.2.3</code></p><p><code class="literal">#JOIN group 224.1.2.4 on interface "eth1"</code></p><p><code class="literal">0.0 JOIN 224.1.2.4 INTERFACE eth1</code></p><p><code class="literal">#JOIN SSM channel 232.1.1.1 with source 26.26.26.1 on interface "eth1"</code></p><p><code class="literal">0.0 JOIN 224.1.2.4 SRC 25.25.25.1 INTERFACE eth1</code></p><p><code class="literal">#JOIN group 224.1.2.5 using socket bound to port 5000</code></p><p><code class="literal">0.0 JOIN 224.1.2.5 PORT 5000</code></p><p>#JOIN group 224.1.2.6 using sockets bound to ports 5001-5005</p><p>0.0 JOIN 224.1.2.6 PORT 5001-5005</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="_LEAVE"></a>5.3.4.&nbsp;LEAVE</h4></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; LEAVE &lt;groupAddress&gt; [SRC &lt;srcAddress&gt;] [INTERFACE &lt;interfaceName&gt;] [PORT &lt;portNumber]</code></p><p>The LEAVE event is used to prompt mgen to "leave" the specific IP multicast group indicated by the &lt;groupAddress&gt; field. The &lt;groupAddress&gt; must have been joined with a prior <a class="link" href="#_JOIN" title="5.3.3.&nbsp;JOIN">JOIN</a> event. The INTERFACE and/or PORT options <span class="emphasis"><em>must</em></span> be used if they were used with the corresponding <a class="link" href="#_JOIN" title="5.3.3.&nbsp;JOIN">JOIN</a> event. Note that the SSM SRC option is not presently available on windows.</p><p>Examples:<code class="literal"></code></p><p><code class="literal">#LEAVE group 224.1.2.3 at time 10.0</code></p><p><code class="literal">10.0 LEAVE 224.1.2.3</code></p><p><code class="literal">#LEAVE group 224.1.2.4 on interface "eth1" at time 10.0</code></p><p><code class="literal">10.0 LEAVE 224.1.2.4 INTERFACE eth1</code></p><p><code class="literal">#LEAVE SSM channel 232.1.1.1 with source 25.25.25.1 on interface "eth1" at time 10.0</code></p><p><code class="literal">10.0 LEAVE 224.1.2.4 SRC 25.25.25.1 INTERFACE eth1</code></p><p><code class="literal">#LEAVE group 224.1.2.4 on interface "eth1"and port 5000 at time 10.0</code></p><p><code class="literal">10.0 LEAVE 224.1.2.4 INTERFACE eth1 PORT 5000</code></p></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_Global_Commands"></a>6.&nbsp;Global Commands</h2></div></div></div><p>The MGEN script file format supports a subset of commands which are independent of normal transmission and reception event scheduling. These are referred to as "Global Commands". This subset includes commands to specify an absolute script execution start time (START command) and to specify default traffic generation characteristics (e.g. multicast INTERFACE, multicast TTL, IP TOS, etc).</p><p>The format of script lines containing global commands is:<code class="literal">&lt;command&gt; &lt;parameters&gt;</code></p><p>In general, a script file should contain only one occurrence of each global command type. If there are multiple occurrences of a command type, the last occurrence will determine mgen's behavior. These commands can also be given on the mgen command-line. Global commands given on the mgen command-line will override any corresponding global commands in the script file(s).</p><p>The MGEN "Global Command" set includes:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td><a class="link" href="#_START" title="6.1.&nbsp;START">START</a></td><td>Specifies an absolute start time for script processing.</td></tr><tr><td><a class="link" href="#_OFFSET" title="6.2.&nbsp;OFFSET">OFFSET</a></td><td>Specifies an offset time into script for MGEN activity.</td></tr><tr><td><a class="link" href="#_TOS" title="6.3.&nbsp;TOS">TOS</a></td><td>Specifies a default IPv4 TOS value for IPv4 flows.</td></tr><tr><td><a class="link" href="#_LABEL" title="6.4.&nbsp;LABEL">LABEL</a></td><td>Specifies a default IPv6 Flow Label for IPv6 flows.</td></tr><tr><td><a class="link" href="#_TTL" title="6.5.&nbsp;TTL">TTL</a></td><td>Specifies a default TTL (time-to-live) hop count for transmitted multicast packets.</td></tr><tr><td><a class="link" href="#">UNICAST_TTL</a></td><td>Specifies a default TTL (time-to-live) hop count for transmitted unicast packets.</td></tr><tr><td><a class="link" href="#_INTERFACE" title="6.12.&nbsp;INTERFACE">INTERFACE</a></td><td>Specifies the name of the default interface to use for IP multicast.</td></tr><tr><td><a class="link" href="#_INPUT" title="6.13.&nbsp;INPUT">INPUT</a></td><td>Specifies the name of a script file to be loaded and parsed.</td></tr><tr><td><a class="link" href="#_OUTPUT" title="6.14.&nbsp;OUTPUT">OUTPUT</a></td><td>Specifies the name of the log file to record logged events. If the named log file pre-exists, it is overwritten.</td></tr><tr><td><a class="link" href="#_LOG" title="6.15.&nbsp;LOG">LOG</a></td><td>Same as OUTPUT, except that pr-existing log files are appended instead of overwritten.</td></tr><tr><td><a class="link" href="#_SAVE" title="6.17.&nbsp;SAVE">SAVE</a></td><td>Specifies a file to which MGEN should store sequence number state for any pending or active flows as well as the current relative script offset time when mgen is terminated.</td></tr><tr><td><a class="link" href="#_TXBUFFER" title="6.7.&nbsp;TXBUFFER">TXBUFFER</a></td><td>Specifies a default socket transmit buffer size.</td></tr><tr><td><a class="link" href="#_RXBUFFER" title="6.8.&nbsp;RXBUFFER">RXBUFFER</a></td><td>Specifies a default socket receive buffer size.</td></tr><tr><td><a class="link" href="#_LOCALTIME" title="6.9.&nbsp;LOCALTIME">LOCALTIME</a></td><td>Specifies that mgen events and error messages are logged in localtime rather than the default Greenwich Mean Time.</td></tr><tr><td><a class="link" href="#_QUEUE" title="6.10.&nbsp;QUEUE">QUEUE</a></td><td>Specifies the default number of mgen messages that should be queued before mgen turns off the transmission timer for a flow.</td></tr><tr><td><a class="link" href="#_LOGDATA" title="6.16.&nbsp;LOGDATA">LOGDATA</a></td><td>Controls whether MGEN will log the optional data attribute field at MGEN receivers (including within MGEN binary log files). It does not affect whether MGEN senders send the requested data attribute. By default LOGDATA is set to ON.</td></tr><tr><td><a class="link" href="#_IPV6">IPV6</a></td><td>Forces mgen to open sockets for IPv6 operation (i.e. AF_INET6 domain sockets) only. The default behavior for mgen is to open sockets with the domain based on environment and the type of IP addresses used in the script file used.</td></tr><tr><td><a class="link" href="#_IPV4">IPV4</a></td><td>Forces mgen to open sockets for IPv4 operation (i.e. AF_INET domain sockets) only. The default behavior for mgen is to open sockets with the domain based on environment and the type of IP addresses used in the script file used.</td></tr><tr><td><a class="link" href="#_DF">DF</a></td><td>Controls whether the DF fragmentation bit is set. {ON|OFF}</td></tr><tr><td><a class="link" href="#_ANALYTICS" title="6.22.&nbsp;ANALYTICS">ANALYTICS</a></td><td>Enables built-in, per-flow analysis of received flows and outputs "REPORT" events to the mgen log file. See <span class="olink">analytics</span> for more detailed information.</td></tr><tr><td><a class="link" href="#_WINDOW" title="6.23.&nbsp;WINDOW">WINDOW</a></td><td>Sets the analysis measurement window for analytics. See <span class="olink">analytics</span> for more detailed information.</td></tr><tr><td><a class="link" href="#_REPORT" title="6.24.&nbsp;REPORT">REPORT</a></td><td>Enables analytic reporting in all transmitting flows. See <span class="olink">report</span> for more detailed information.</td></tr><tr><td><a class="link" href="#_SUSPEND_GLOBAL" title="6.25.&nbsp;SUSPEND">SUSPEND &lt;flowId|range|all&gt;</a></td><td>Suspends a <span class="emphasis"><em>local</em></span> flow (i.e. as opposed to the control of remote flows that inserting this options into a flow event provides). The main use for this would be to suspend flows upon startup so that they may be activated later upon receipt of remote flow command "resume" or "reset" messages. For example:<pre class="programlisting">mgen event "on 1 udp dst 127.0.0.1/5001 per [1 1024]" suspend 1</pre><p>would create a flow with flowid "1" that is immediately suspended (e.g. not transmitting) upon startup. Then later, if a 'resume' or 'reset' remote flow command is received, the flow would be activated and begin transmitting upon command. They keyword "all" can also be used with the suspend command (but not with the corresponding flow event option) to take action on <span class="emphasis"><em>all</em></span> flows. For example:</p><pre class="programlisting">mgen event "on 1 udp dst 127.0.0.1/5001 per [1 1024]" event "on 2 udp dsdt 127.0.0.1/5002 per [1 1024]" suspend all"</pre><p>would create two flows that are suspended upon MGEN startup.</p></td></tr><tr><td><a class="link" href="#_RESUME_GLOBAL" title="6.26.&nbsp;RESUME">RESUME &lt;flowId|range|all&gt;</a></td><td>Resumes a <span class="emphasis"><em>local</em></span> flow (i.e. as opposed to the control of remote flows that inserting this options into a flow event provides). The main use for this would be to resume flows that have been previously suspended in a local mgen instance. For example:<pre class="programlisting">mgen instance mgen1 event "on 1 udp dst 127.0.0.1/5001 per [1 1024]" suspend 1</pre><p>would create a flow with flowid "1" that is immediately suspended (e.g. not transmitting) upon startup. Then later, the global 'resume' command can be used to activate the suspended flow. </p><pre class="programlisting">mgen instance mgen1 resume 1</pre><p>They keyword "all" can also be used with the resume command (but not with the corresponding flow event option) to take action on <span class="emphasis"><em>all</em></span> flows. For example:</p><pre class="programlisting">mgen instance mgen1 resume all</pre><p>would resume all flow(s) suspended in mgen instance mgen1.</p></td></tr><tr><td><a class="link" href="#_RESET_GLOBAL" title="6.27.&nbsp;RESET">RESET &lt;flowId|range|all&gt;</a></td><td>Resets a <span class="emphasis"><em>local</em></span> flow (i.e. as opposed to the control of remote flows that inserting these options into a flow event provides). The main use for this would be to reset flows managed by local mgen instances. When a "reset" command is received, the sender flow message counter is reset and the flow will continue transmitting count messages. For example:<pre class="programlisting">mgen instance mgen1 event "on 1 udp dst 127.0.0.1/5001 per [1 1024] count 10" </pre><p>would create a flow with flowid "1" that is scheduled to send 10 messages upon startup. Then later, when a 'reset' remote flow command is received, the flow would be activated and begin retransmitting 10 messages. For example: flows. For example:</p><pre class="programlisting">mgen instance mgen1 reset 1</pre><p>would cause the counter for the flow to be reset and an additional 10 messages would be sent. If the counter has already expired the reset message will have no effect.</p></td></tr><tr><td><a class="link" href="#_RETRY_GLOBAL" title="6.28.&nbsp;RETRY">RETRY&lt;count&gt;[/&lt;delay&gt;]</a></td><td>Sets the default retry count and delay for all data flows. If the underlying TCP socket for the flow fails to connect, or disconnects, attempt to reconnect the socket &lt;count&gt; times after &lt;delay&gt; seconds. The default retry interval is 5 seconds. The transport will attempt to reconnect over the life of the flow if the retry count is set to -1. If multiple flows are sharing the transport a common retry pattern should be used by all the flows or the last attribute set "wins".</td></tr></tbody></table></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_START"></a>6.1.&nbsp;START</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">START &lt;hour:min:sec&gt;[GMT]</code></p><p>The START command designates an absolute time as indicated by the <code class="literal">&lt;hour:min:sec&gt;</code> field to correspond to the relative script time of 0.0 seconds. All transmission and reception events will be scheduled relative to this absolute start time. The optional GMT suffix (no white space after the time) indicates that the clock time given is Greenwich Mean Time (GMT) rather than the operating systems local time zone. If no START command is given, mgen schedules transmission and reception events relative to program startup.</p><p>Example:</p><p><code class="literal">#Start MGEN exactly at 1:30PM local time</code></p><p><code class="literal">START 13:30:00</code></p><p><code class="literal">#Start MGEN at 30 seconds past 8:30 GMT</code></p><p><code class="literal">START 8:30:30GMT</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_OFFSET"></a>6.2.&nbsp;OFFSET</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">OFFSET &lt;seconds&gt;</code></p><p>The OFFSET global command specifies a relative time offset (in seconds)into script processing where MGEN should begin its activity. This allows multiple instances of MGEN using the same script to be dithered as desired. Additionally, this command may be used to immediately restore MGEN to a specific scripted state other than the beginning of the script upon launch.</p><p>Example:</p><p>#Skip the first 10 seconds of an MGEN script</p><p><code class="literal">OFFSET 10.0</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_TOS"></a>6.3.&nbsp;TOS</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">TOS &lt;value&gt;</code></p><p>The TOS command specifies ...</p><p>Example:</p><p><code class="literal">#Specify default tos = 0x10 (low delay)</code></p><p><code class="literal">TOS 0x10</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_LABEL"></a>6.4.&nbsp;LABEL</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">LABEL &lt;value&gt;</code></p><p>The LABEL command specifies a default value to be used as the "flow label" for IPv6 flows. The "flow label" is the corresponding 28-bit field in the IPv6 packet header. Refer to the Transmission Event <a class="link" href="#_IPv6_Flow_Label" title="5.2.10.&nbsp;Socket Transmit Buffer Size (TXBUFFER)">LABEL</a> option for further details..</p><p>Example:</p><p><code class="literal">#Specify default IPv6 flow label = 0x02500000</code></p><p><code class="literal">LABEL 0x02500000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_TTL"></a>6.5.&nbsp;TTL</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">TTL &lt;value&gt;</code></p><p>The TTL command specifies the default time-to-live (TTL) hop count for generated IP multicast traffic according to the &lt;value&gt; field. The &lt;value&gt; must be in the range of 1-255. If the global TTL command is not used, mgen assumes a default multicast TTL value of 1. Note that the transmission event TTL option will override the default specification given by this global command.</p><p>Example:</p><p><code class="literal">#Specify default multicast flow ttl = 32</code></p><p><code class="literal">TTL 32</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_TUNICAST_TTL"></a>6.6.&nbsp;UNICAST_TTL</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">UNICAST_TTL &lt;value&gt;</code></p><p>The TTL command specifies the default unicast time-to-live (TTL) hop count for generated IP unicast traffic according to the &lt;value&gt; field. The &lt;value&gt; must be in the range of 1-255. If the global UNICAST_TTL command is not used, mgen assumes a default unicast TTL value of 255. Note that the transmission event TTL option will override the default specification given by this global command.</p><p>Example:</p><p><code class="literal">#Specify default unicast flow ttl = 32</code></p><p><code class="literal">UNICAST_TTL 32</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_TXBUFFER"></a>6.7.&nbsp;TXBUFFER</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">TXBUFFER &lt;txBufferSize&gt; ...</code></p><p>This option allows users to set the default socket transmit buffer size to a value at least as large as &lt;txBufferSize&gt;. The exact behavior of this option may be operating system dependent. The TXBUFFER option given on transmission event script lines will override this default for the socket used by the corresponding flow.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_RXBUFFER"></a>6.8.&nbsp;RXBUFFER</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">RXBUFFER &lt;rxBufferSize&gt; ...</code></p><p>This option allows users to set the default socket receive buffer size to a value ?at least? as large as &lt;rxBufferSize&gt;. The exact behavior of this option may be operating system dependent. The RXBUFFER option given on transmission event script lines will override this default for the socket used by the corresponding flow.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_LOCALTIME"></a>6.9.&nbsp;LOCALTIME</h3></div></div></div><p>Script syntax:</p><p><code class="literal">LOCALTIME</code></p><p>This option allows users to specify that events and error messages be logged in localtime rather than the default Greenwich Mean Time.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_QUEUE"></a>6.10.&nbsp;QUEUE</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">QUEUE</code></p><p>This global command will cause mgen to buffer &lt;queueSize&gt; mgen packets for each flow during periods of congestion. (Note that flow specific limits specified at the transmission event level will override this global). When the number of pending messages for a flow exceeds this limit, the message transmission timer will be temporarily deactivated and any pending messages will transmitted as quickly as possible. The timer will be reactivated once the pending message count falls below the queue limit, and message transmission will return to the previously scheduled rate of transmission.</p><p>If no global command is specified, a default &lt;queueSize&gt; of "0" will be in effect which will result in no queuing behavior, e.g. the transmission timer will continue to fire at its regularly scheduled interval regardless of transport congestion. No pending message count will be accumulated and message transmission will suceed or fail depending on transport availability.</p><p>When multiple flows are sending messages over a common mgen transport, the flows that have exceeded their pending message limit(s) will be serviced in a round robin fashion until all pending messages have been sent for all flows. Transmissions for flows that have fallen below this threshold will be interleaved as scheduled.</p><p>A &lt;queueSize&gt; threshold of "-1" sets an unlimited queue size. This means that a congested flow's transmission timer will continue to fire (thereby building up it's pending message count), but any pending messages will be sent as quickly as possible until congestion clears.</p><p>Any pending messages for a flow will be sent before the flow will be shutdown by a scheduled <a class="link" href="#_OFF_Event" title="5.1.3.&nbsp;OFF Event">OFF</a> event. Likewise, the pending message queue for a flow that is being restarted will be cleared. Note however, if any of the content of the mgen message header is changed (src or dst addresses, etc.) the pending message count will be reset. All other flow attribute changes (rage, message size, payload content, ttl, etc.) will be effected immediately, including any pending messages.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2244"></a>6.11.&nbsp;DATA</h3></div></div></div><p>Script Syntax:</p><pre class="programlisting">DATA [&lt;hex&gt;[&lt;hex&gt;[&lt;hex&gt;...]]]</pre><p>User defined message payload can be specified with the DATA command. The data should be a hexadecimal representation of the user data where each pair of characters corresponds to one byte of user data. The contents will be placed in every packet generated by the flow.</p><pre class="programlisting">./mgen event "ON 1 UDP DST 127.0.0.1/5000 Periodic [1 1024] DATA [fffeffff]" event "LISTEN UDP 5000"
mgen: version 5.1.1
mgen: starting now ...
19:39:06.617625 START Mgen Version 5.1.1
19:39:06.618078 ON flow&gt;1 srcPort&gt;59275 dst&gt;127.0.0.1/5000 
19:39:06.618168 LISTEN proto&gt;UDP port&gt;5000
19:39:06.618340 RECV proto&gt;UDP flow&gt;1 seq&gt;0 src&gt;127.0.0.1/59275 dst&gt;127.0.0.1/5000 sent&gt;19:39:06.618199 size&gt;1024 gps&gt;INVALID,999.000000,999.000000,4294966297 data&gt;4:FFFEFFFF 
19:39:07.620218 RECV proto&gt;UDP flow&gt;1 seq&gt;1 src&gt;127.0.0.1/59275 dst&gt;127.0.0.1/5000 sent&gt;19:39:07.619975 size&gt;1024 gps&gt;INVALID,999.000000,999.000000,4294966297 data&gt;4:FFFEFFFF </pre><p>The data is inserted in each packet once and the remainder of the packet, if any, is filled with zeros (unless compiled with RANDOM_FILL).  </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_INTERFACE"></a>6.12.&nbsp;INTERFACE</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">&lt;interfaceName&gt;</code></p><p>The INTERFACE command specifies a default IP network interface to use for multicast traffic generation and group membership. If no INTERFACE command is given, the default operating system behavior is observed. Note that the transmission event INTERFACE option or the JOIN reception event INTERFACE option will override the default specification given by this global command.</p><p>Example:</p><p><code class="literal">#Specify "eth1" as the default network interface</code></p><p><code class="literal">#for multicast transmission and group joins</code></p><p><code class="literal">INTERFACE eth1</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_INPUT"></a>6.13.&nbsp;INPUT</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">INPUT &lt;scriptFile&gt;</code></p><p>The INPUT command cause MGEN to load and parse the given &lt;scriptFile&gt;. (Circular references are not detected by mgen and should be avoided_). This allows scripts to "include" other scripts. The parsing occurs in the order that the INPUT commands are encountered on the command-line and within the script files themselves.</p><p>Example:</p><p><code class="literal">#Load and parse the MGEN script file "script2.mgn"</code></p><p><code class="literal">INPUT script2.mgn</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_OUTPUT"></a>6.14.&nbsp;OUTPUT</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">OUTPUT &lt;logFile&gt;</code></p><p>The OUTPUT command cause mgen to direct its log output to the indicated &lt;logFile&gt;. The last occurring OUTPUT command determines the log file to be used and the command-line takes precedence over any scripts provided as input to mgen. The file named by &lt;logFile&gt; will be overwritten if it already exists.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Use the file "logFile.drc" for logging</code></p><p><code class="literal">OUTPUT logFile.drc</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_LOG"></a>6.15.&nbsp;LOG</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">LOG &lt;logFile&gt;</code></p><p>The LOG command cause mgen to direct its log output to the indicated &lt;logFile&gt;. The last occurring LOG command determines the log file to be used and the command-line takes precedence over any scripts provided as input to mgen. The file named by &lt;logFile&gt; will be appended if it already exists.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Append the file "logFile.drc"</code></p><p><code class="literal">LOG logFile.drc</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_LOGDATA"></a>6.16.&nbsp;LOGDATA</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">LOGDATA {on|off}}</code></p><p>Controls whether MGEN will log the optional data attribute field at MGEN receivers (including within MGEN binary log files). It does not affect whether MGEN senders send the requested data attribute. By default LOGDATA is set to ON.</p><p>Example:<code class="literal"></code></p><p><code class="literal">#Don't log optional data attribute at receiver</code></p><p><code class="literal">LOGDATA off</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_SAVE"></a>6.17.&nbsp;SAVE</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">SAVE &lt;saveFile&gt;</code></p><p>The SAVE command causes mgen to write a short MGEN script upon exit which includes current sequence number state for pending and active transmission flows as well as the current relative script offset time. If the &lt;saveFile&gt; created is given as an additional input script (with the <span class="emphasis"><em>same</em></span> input script(s) given for the mgen instance which created &lt;saveFile&gt;), on a subsequent launch of mgen, mgen will return to the same state as it was when it previously exited.</p><p>The SAVE command can be used when it is desired to conduct separate runs of mgen, but preserve a continuous sequence number space across the multiple runs. An example script performing this function is given below. Note the same behavior can also be achieved via the mgen command-line using:</p><p>"<code class="literal">mgen input &lt;scriptFile&gt; input &lt;saveFile&gt; save &lt;saveFile&gt; log &lt;logFile&gt;"</code></p><p>if an empty &lt;saveFile&gt; is provided on the first launch of mgen.</p><p>Example:<code class="literal"></code></p><p><code class="literal"># This script executes another MGEN script, using</code></p><p><code class="literal"># "saveFile.mgn" for state recovery upon subsequent</code></p><p><code class="literal"># restarts after mgen is exited.</code></p><p><code class="literal"># (If "saveFile.mgn" is empty or non-existent upon</code></p><p><code class="literal"># initial startup, the "scriptFile.mgn" is run</code></p><p><code class="literal"># from the beginning.)</code></p><p><code class="literal"># (The "log" command is used to repeatedly append</code></p><p><code class="literal"># the "logFile.drc" file upon stop and restart)</code></p><p><code class="literal">INPUT scriptFile.mgn</code></p><p><code class="literal">INPUT saveFile.mgn</code></p><p><code class="literal">SAVE saveFile.mgn</code></p><p><code class="literal">LOG logFile.drc</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2419"></a>6.18.&nbsp;SEED</h3></div></div></div><p>Script syntax:</p><p>SEED &lt;int&gt;</p><p>Seeds the random number generator with the provided int value. If no seed is provided, the current time is used.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_IPV6"></a>6.19.&nbsp;IPv6</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">IPv6</code></p><p>Forces mgen to open sockets for IPv6 operation (i.e. AF_INET6 domain sockets) only. The default behavior for mgen is to open sockets with the domain based on environment and the type of IP addresses used in the script file used.</p><p>Example:<code class="literal"></code></p><p><code class="literal"># Global IPv6 option</code></p><p>IPV6</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_IPV4"></a>6.20.&nbsp;IPv4</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">IPv4</code></p><p>Forces mgen to open sockets for IPv4 operation (i.e. AF_INET domain sockets) only. The default behavior for mgen is to open sockets with the domain based on environment and the type of IP addresses used in the script file used.</p><p>Example:<code class="literal"></code></p><p><code class="literal"># Gloval IPv4 option</code></p><p><code class="literal">IPv4</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_DF"></a>6.21.&nbsp;DF</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">DF {ON|OFF}</code></p><p>Controls whether the DF fragmentation bit is set.</p><p>Example:<code class="literal"></code></p><p><code class="literal"># Set DF fragmentation bit</code></p><p><code class="literal">DF on</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_ANALYTICS"></a>6.22.&nbsp;ANALYTICS</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">ANALYTICS </code></p><p>Enables build-in, per-flow analysis of received flows and outputs "REPORT" events to the mgen log file. The analysis (similar to NRL's TRPR) product includes:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>average received goodput rate for the given <a class="link" href="#_REPORT" title="6.24.&nbsp;REPORT">REPORT</a> "window" time</p></li><li class="listitem"><p>loss fraction measured for the given <a class="link" href="#_REPORT" title="6.24.&nbsp;REPORT">REPORT</a> "window" time</p></li><li class="listitem"><p>average, minimum, and maximum latency for the given <a class="link" href="#_REPORT" title="6.24.&nbsp;REPORT">REPORT</a> "window" time</p></li></ol></div><p>For example,</p><pre class="programlisting">mgen event "listen udp 5000" analytics window 10</pre><p>would measure and log received message statistics once per 10 seconds for each flow detected.</p><p>The "window" command can be used to set the analysis measurement window. A window of about 1 second is the default value. The window SHOULD be set large enough to have multiple messages per window time for useful measurement. The format of the REPORT lines are similar to other MGEN events. For example, locally generated report events have a an offset value of 0.0:</p><pre class="programlisting">01:17:01.983235 REPORT proto&gt;UDP flow&gt;3 src&gt;127.0.0.1/63684 dst&gt;127.0.0.1/5002 offset&gt;0.000000 window&gt;1.970563 rate&gt;10.000000 kbps loss&gt;0.000000 latency ave&gt;0.000119 min&gt;0.000109 max&gt;0.000129</pre><p>REPORT events from remote MGEN instances include a sent&gt; field:</p><pre class="programlisting">01:17:01.983235 REPORT proto&gt;UDP flow&gt;3 src&gt;127.0.0.1/63684 dst&gt;127.0.0.1/5002 sent&gt;01:16.58.675309 offset&gt;0.000000 window&gt;1.970563 rate&gt;10.000000 kbps loss&gt;0.000000 latency ave&gt;0.000119 min&gt;0.000109 max&gt;0.000129</pre><p>The first timestamp field minus the value of the "offset" field is when the reported measurement was computed (i.e. the time of the <span class="emphasis"><em>end</em></span> of the given averaging window being reported.) The "offset" is useful when receiving report content from the remote MGEN senders and not a locally generated report. (Locally generated REPORT events the "offset" will be zero.) The "window" field indicates what averaging window was used for the report (e.g., it may be different for remote MGEN senders depending on how their "window" was set.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_WINDOW"></a>6.23.&nbsp;WINDOW</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">WINDOW &lt;secs&gt;</code></p><p>Sets the report analysis measurement window. A window of about 1 second is the default value. The window should be set large enough to have multiple messages per window time for useful measurement. The "window" field in the report line, e.g.</p><pre class="programlisting">01:17:01.983235 REPORT proto&gt;UDP flow&gt;3 src&gt;127.0.0.1/63684 dst&gt;127.0.0.1/5002 offset&gt;0.000000 window&gt;1.970563 rate&gt;10.000000 kbps loss&gt;0.000000 latency ave&gt;0.000119 min&gt;0.000109 max&gt;0.000129</pre><p>indicates what averaging window was used for the report (e.g., the window in reports transmitted by remote MGEN senders may be different than locally generated MGEN reports depending on how their "window" command was set")</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_REPORT"></a>6.24.&nbsp;REPORT</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">REPORT</code></p><p>Enables <a class="link" href="#_ANALYTICS" title="6.22.&nbsp;ANALYTICS">analytics</a> reporting in all transmitting flows, meaning each flow will include in their transmitted MGEN message payload content per-flow analytics reports. MGEN nodes that receive these "report" payloads will also log those as REPORT event in their log files in addition to the usual RECV events. Note that the receiving mgen must have the <a class="link" href="#_ANALYTICS" title="6.22.&nbsp;ANALYTICS">analytics</a> global set in order to log the REPORT messages. Thought should be given to what reporting is required when considering the global REPORT option versus the per flow REPORT option as a single flow can report for all received flows and multiple reporting flows will be redundant (even though this reporting is "in-band" of scripted message generation.) The metrics reported as sufficiently quantized to enable compact reports and that enables reporting potentially on many received flows in a single transmitted MGEN message. See the flow <a class="link" href="#_FLOW_REPORT" title="5.2.17.&nbsp;REPORT">REPORT</a> option for more detailed information on this capability.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_SUSPEND_GLOBAL"></a>6.25.&nbsp;SUSPEND</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">SUSPEND &lt;flowId|range|all&gt;</code></p><p>Suspends a local flow (i.e. as opposed to the control of remote flows that inserting this options into a flow event provides). The main use for this would be to suspend flows upon startup so that they may be activated later upon receipt of remote flow command "resume" or "reset" messages. For example: </p><pre class="programlisting">mgen event "on 1 udp dst 127.0.0.1/5001 per [1 1024]" suspend 1</pre><p> would create a flow with flowid "1" that is immediately suspended (e.g. not transmitting) upon startup. Then later, if a 'resume' or 'reset' remote flow command is received, the flow would be activated and begin transmitting upon command. They keyword "all" can also be used with the suspend command (but not with the corresponding flow event option) to take action on all flows. For example: </p><pre class="programlisting">mgen event "on 1 udp dst 127.0.0.1/5001 per [1 1024]" event "on 2 udp dsdt 127.0.0.1/5002 per [1 1024]" suspend all"</pre><p> would create two flows that are suspended upon MGEN startup. Note that the suspend global command can be send to an mgen instance.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_RESUME_GLOBAL"></a>6.26.&nbsp;RESUME</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">SUSPEND &lt;flowId|range|all&gt;</code></p><p>Resumes a local flow (i.e. as opposed to the control of remote flows that inserting this options into a flow event provides). The main use for this would be to resume flows that have been previously suspended in a local mgen instance. For example:</p><pre class="programlisting">mgen event "on 1 udp dst 127.0.0.1/5001 per [1 1024]" suspend 1</pre><p> would create a flow with flowid "1" that is immediately suspended (e.g. not transmitting) upon startup. Then later, the global 'resume' command can be used to activate the suspended flow.</p><pre class="programlisting">mgen instance mgen1 resume 1</pre><p> They keyword "all" can also be used with the resume command (but not with the corresponding flow event option) to take action on all flows. For example:</p><pre class="programlisting">mgen instance mgen1 resume all</pre><p>would resume all flow(s) suspended in mgen instance mgen1</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_RESET_GLOBAL"></a>6.27.&nbsp;RESET</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">RESET &lt;flowId|range|all&gt;</code></p><p>Resets a local flow (i.e. as opposed to the control of remote flows that inserting these options into a flow event provides). The main use for this would be to reset flows managed by local mgen instances. When a "reset" command is received, the sender flow message counter is reset and the flow will continue transmitting count messages. For example:</p><pre class="programlisting">mgen instance mgen1 event "on 1 udp dst 127.0.0.1/5001 per [1 1024] count 10" </pre><p> would create a flow with flowid "1" that is scheduled to send 10 messages upon startup. Then later, when a 'reset' remote flow command is received, the flow would be activated and begin retransmitting 10 messages. For example: flows. For example:</p><pre class="programlisting">mgen instance mgen1 reset 1</pre><p> would cause the counter for the flow to be reset and an additional 10 messages would be sent. If the counter has already expired the reset message will have no effect.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_RETRY_GLOBAL"></a>6.28.&nbsp;RETRY</h3></div></div></div><p>Script syntax:<code class="literal"></code></p><p><code class="literal">RETRY &lt;count&gt;[/&lt;delay&gt;]</code></p><p>Sets the default retry behavior for all flows. If the underlying TCP socket for the flow fails to connect, or disconnects, attempt to reconnect the socket &lt;count&gt; times after &lt;delay&gt; seconds. The default retry interval is 5 seconds. The transport will attempt to reconnect over the life of the flow if the retry count is set to -1. If multiple flows are sharing the transport a common retry pattern should be used by all the flows or the last attribute set "wins".</p><p>For example:</p><p>Attempt to connect every five seconds:</p><pre class="programlisting">ON 1 TCP DST 127.0.0.1/5000 PERIODIC [1 1024] RETRY -1/5 </pre><p>Attempt to connect twice after initial failure every 3 seconds</p><pre class="programlisting">ON 1 TCP DST 127.0.0.1/5000 PERIODIC [1 1024] RETRY 2/3 </pre><p>RECONNECT events are logged at each reconnect attempt:</p><pre class="programlisting">17:36:12.762619 RECONNECT flow&gt;1 srcPort&gt;35859 dst&gt;127.0.0.1/5000 
17:36:17.763483 RECONNECT flow&gt;1 srcPort&gt;46864 dst&gt;127.0.0.1/5000 
17:36:22.764783 RECONNECT flow&gt;1 srcPort&gt;46866 dst&gt;127.0.0.1/5000 </pre></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_MGEN_Log_File"></a>7.&nbsp;MGEN Log File Format</h2></div></div></div><p><a name="b5"></a><a name="b7"></a>The MGEN message format contains information to facilitate network performance measurements through post-analysis of MGEN log files. Some of the types of performance statistics which can be determined include:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>Message Throughput</td><td>The time or arrival and size of received messages are logged by MGEN receivers. Network throughput can be assessed with this information.</td></tr><tr><td>Message Delivery Latency</td><td>MGEN messages contain a timestamp reflecting when they were sent and the time of reception is logged by MGEN receivers. Delivery latency statistics (jitter or absolute if clock synchronization (e.g. NTP) is possible) can be determined with this information.</td></tr><tr><td>Message Loss Rate</td><td>MGEN messages are sequence numbered. Message loss can be accounted for via analysis of logged sequence number information.</td></tr><tr><td>Message Re-ordering</td><td>The logged MGEN sequence number information can also be used to determine message re-ordering statistics.</td></tr><tr><td>Multicast JOIN/LEAVE Latency</td><td>The occurrence and time of JOIN/LEAVE events are logged by MGEN receivers. The JOIN latency can be determined by comparing the arrival time of the first message associated with a particular multicast group to the time the group was joined. The LEAVE latency can be determined by comparing the time of the _last_ packet arrival time to the time the receiver left that multicast group (Note that you need a packet sniffing program like <a class="ulink" href="http://www.tcpdump.org/" target="_top">tcpdump</a> to see packets after you leave the group).</td></tr></tbody></table></div><p>Many of the above performance measures and statistics can be measured and optionally graphed using the NRL <a class="ulink" href="http://pf.itd.nrl.navy.mil/proteantools/trpr.html" target="_top">trpr</a> (trace plot real-time) program. This program can parse the MGEN log file format and <a class="ulink" href="http://www.tcpdump.org/" target="_top">tcpdump</a> traces.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="General_Log_Format"></a>7.1.&nbsp;General Log Format</h3></div></div></div><p>Each line of the MGEN text log file format corresponds to a unique event and follows the convention:&lt;eventTime&gt; &lt;eventType&gt; &lt;event attributes ...&gt;The &lt;eventTime&gt; field is in the form hrs:min:sec and represents the computer's system Greenwich Mean Time (GMT) at the time of the event.</p><p>The &lt;eventType&gt; field is one of the following:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td><a class="link" href="#_Log_File_RECV" title="7.2.&nbsp;Log File RECV Events">RECV</a></td><td>Denotes the arrival of a received MGEN message.</td></tr><tr><td><a class="link" href="#_Log_File_RERR" title="7.3.&nbsp;Log File RERR Events">RERR</a></td><td>Indicates an invalid MGEN message was received.</td></tr><tr><td><a class="link" href="#_Log_File_SEND_Events" title="7.4.&nbsp;Log File SEND Events">SEND</a></td><td>Denotes the transmission of an MGEN message.</td></tr><tr><td><a class="link" href="#_Log_File_JOIN" title="7.5.&nbsp;Log File JOIN Events">JOIN</a></td><td>Marks a join to an IP multicast group.</td></tr><tr><td><a class="link" href="#_Log_File_LEAVE" title="7.6.&nbsp;Log File LEAVE Events">LEAVE</a></td><td>Marks the departure from an IP multicast group.</td></tr><tr><td><a class="link" href="#_Log_File_LISTEN" title="7.7.&nbsp;Log File LISTEN Events">LISTEN</a></td><td>Indicates when mgen began monitoring a specific port</td></tr><tr><td><a class="link" href="#_Log_File_IGNORE" title="7.8.&nbsp;Log File IGNORE Events">IGNORE</a></td><td>Indicates when mgen ended monitoring of a specific port</td></tr><tr><td><a class="link" href="#_Log_File_ON" title="7.9.&nbsp;Log File ON Events">ON</a></td><td>Indicates when mgen initiated a TCP connection to the indicated destination ip address and port or when a UDP flow began transmitting.</td></tr><tr><td><a class="link" href="#_Log_File_CONNECT" title="7.10.&nbsp;Log File CONNECT Events">CONNECT</a></td><td>Indicates when an mgen TCP "client" or "sender" has established a TCP connection from the indicated source port or to the destination ip address and port.</td></tr><tr><td><a class="link" href="#_Log_File_RECONNECT" title="7.14.&nbsp;Log File RECONNECT Events">RECONNECT</a></td><td>Indicates when an mgen TCP "client" as attempted to reestablished a TCP connection from the indicated source port or to the destination ip address and port.</td></tr><tr><td><a class="link" href="#_Log_File_ACCEPT" title="7.11.&nbsp;Log File ACCEPT Events">ACCEPT</a></td><td>Indicates when an mgen TCP "server" or "listener" has accepted a TCP connection from the indicated source ip address and port to the destination port.</td></tr><tr><td><a class="link" href="#_Log_File_DISCONNECTED" title="7.13.&nbsp;Log File DISCONNECT Events">SHUTDOWN</a></td><td>Indicates when an mgen TCP connection was shutdown after a scheduled &gt;OFF&lt; event on the client side or when an active connection is shutdown by the server on the server side. When TCP completes the shutdown procedure, an OFF or a DISCONNECT event will be logged as appropriate.</td></tr><tr><td><a class="link" href="#_Log_File_SHUTDOWN" title="7.12.&nbsp;Log File SHUTDOWN Events">DISCONNECT</a></td><td>Indicates when an mgen TCP connection was disconnected prior to a scheduled &gt;OFF&lt; event on either the client or server side. This event indicates a TCP error has occurred on the connection. (NOTE: this indication of an unscheduled TCP shutdown is currently reliable only on Linux systems.)</td></tr><tr><td><a class="link" href="#_Log_File_OFF" title="7.15.&nbsp;Log File OFF Events">OFF</a></td><td>Indicates that an mgen flow was stopped by a scheduled &gt;OFF&lt; event on the client or by a server IGNORE event on the sever. (Only available when transmission logging is enabled on the client side).</td></tr><tr><td><a class="link" href="#_Log_File_Start_Stop" title="7.16.&nbsp;Log File START and STOP Events">START</a></td><td>Indicates when mgen started processing Transmission and Reception events.</td></tr><tr><td><a class="link" href="#_Log_File_Start_Stop" title="7.16.&nbsp;Log File START and STOP Events">STOP</a></td><td>Indicates when mgen stopped processing Transmission and Reception events.</td></tr></tbody></table></div><p>Different event types will have different event attribute sets. The &lt;event attribute&gt; fields are explicitly labeled so that log file parsing programs can seek specific attributes of interest for given event types.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_RECV"></a>7.2.&nbsp;Log File RECV Events</h3></div></div></div><p>The format of the RECV event log file line is:</p><p><code class="literal">&lt;eventTime&gt; RECV proto&gt;&lt;protocol&gt; flow&gt;&lt;flowId&gt; seq&gt;&lt;sequenceNumber&gt; src&gt;&lt;addr&gt; /&lt;port&gt; dst&gt;&lt;addr&gt;/&lt;port&gt; sent&gt;&lt;txTime&gt; size&gt;&lt;bytes&gt; [host&gt;&lt;addr&gt;/&lt;port&gt;] [gps&gt;&lt;status&gt;,&lt;lat&gt;,&lt;long&gt;,&lt;alt&gt;] [data&gt;&lt;len&gt;:&lt;data&gt;] [flags&gt;&lt;flag&gt;]</code></p><p>The &lt;eventTime&gt; corresponds to when the message was received. The &lt;protocol&gt; specifies the protocol (udp,tcp,sink).The &lt;flowId&gt;, &lt;sequenceNumber&gt;, and &lt;txTime&gt;, are from the payload of the MGEN message. The &lt;txTime&gt; is in the same format as the &lt;eventTime&gt; (i.e. &lt;hr:min:sec&gt; GMT)</p><p>The "dst" &lt;addr&gt;/&lt;port&gt; is from the message payload and corresponds to the destination address to which the source addressed the MGEN message.</p><p>The "src" &lt;addr&gt;/&lt;port&gt; is the source address determined from the corresponding <code class="literal">recvfrom()</code> call for UDP transport or the address to which the TCP connection was made. (An optional "host" address will be embedded in the payload by the MGEN message source and made available as an attribute of the logged RECV event in the future).</p><p>The message "size" in &lt;bytes&gt; is also from the payload, but for UDP transport, should also correspond to the UDP packet payload size. Note that TCP mgen messages can be larger than the maximum UDP message size of 8192 bytes and can be of unlimited size. Therefore, mgen breaks large TCP messages into mgen message "fragments" of a maximum size of 65535 and sets a flag on the mgen message to indicate that it is a TCP message "fragment". Message fragments are flagged with 0x01 to indicate that the message is not complete. The last fragment in a TCP message is flagged 0x02 to indicate "end of message".</p><p>For example, a TCP mgen message of size 66559 will be received and logged by the receiving node as two messages as follows:</p><p>00:33:36.427143 RECV proto&gt;TCP flow&gt;1 seq&gt;1 src&gt;10.0.0.1/35056 dst&gt;10.0.0.2/5000 sent&gt;00:36:11.377105 size&gt;65535 gps&gt;INVALID,999.000000,999.000000,-999 flags&gt;0x01</p><p>00:33:36.427499 RECV proto&gt;TCP flow&gt;1 seq&gt;1 src&gt;10.0.0.1/35056 dst&gt;10.0.0.1/5000 sent&gt;00:36:11.380137 size&gt;1024 gps&gt;INVALID,999.000000,999.000000,-999 flags&gt;0x02</p><p>Also note that a single SEND message will be logged by the transmitting node with a size corresponding to the TCP message size, e.g.:</p><p>00:29:51.396962 SEND proto&gt;TCP flow&gt;1 seq&gt;1 srcPort&gt;0 dst&gt;10.0.0.2/5000 size&gt;66559</p><p>The "host" &lt;addr&gt;/&lt;port&gt; corresponds to the MGEN message source's "perceived" default local address. Note that this may be different from the source address contained in the MGEN log file due to firewalls, Network Address Translation (NAT) devices, multi-homed sources, etc. The accuracy of this information depends upon the source host's configuration with regards to domain name service (DNS), etc. Note this field is optional and may not be present if this information is not valid (The current initial MGEN release does not yet support this option).</p><p>The "src", "dst", and "host" &lt;addr&gt; fields are dotted decimal IPv4 addresses or colon-delimited IPv6 addresses.</p><p>The "flags" field is discussed above.</p><p>The global positioning system (GPS) information is available when the MGEN message source is used in conjunction with the NRL <a class="ulink" href="http://pf.itd.nrl.navy.mil/proteantools/gpsLogger.html" target="_top">gpsLogger</a> program. This program monitors an attached GPS receiver for position information and "publishes" it in shared memory. When mgen is run and detects that it can "subscribe" to GPS position information, it places it in the MGEN message payload. Note that <a class="ulink" href="http://pf.itd.nrl.navy.mil/proteantools/gpsLogger.html" target="_top">gpsLogger</a> can also be used with a pulse-per-second (PPS) capable GPS receiver to provide accurate time synchronization for hosts running the MGEN toolset. This may be useful for mobile network test environments. The MGEN log file "gps" attribute has the following comma-delimited fields:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>&lt;status&gt;</td><td>This indicates the validity of the GPS information and may be either "INVALID", "CURRENT", or "STALE".</td></tr><tr><td>&lt;lat&gt;</td><td>This is the GPS latitude in degrees. A negative value denotes South while a positive value denotes North.</td></tr><tr><td>&lt;long&gt;</td><td>This is the GPS longitude in degrees. A negative value denotes West while a positive value denotes East.</td></tr><tr><td>&lt;alt&gt;</td><td>This is the GPS altitude in meters.</td></tr></tbody></table></div><p>The optional "data" attribute is present only if the received MGEN message contains optional user-defined payload. If present, the &lt;len&gt; indicates the length (in bytes) of the user-defined payload and the &lt;data&gt; following the colon character':' is a hexadecimal representation of the user data where each pair of characters corresponds to one byte of user data. Thus, the number of characters in the &lt;data&gt; field will be 2 * &lt;len&gt;. (The "data" option was supported in MGEN 3.x via the MGEN Payload Manager (mpmgr) tool and is not yet supported in MGEN 4.x. The documentation will be updated when this option is supported).</p><p>Example RECV event log lines:<code class="literal"></code></p><p><code class="literal">22:59:52.312721 RECV proto&gt;&lt;protocol&gt; flow&gt;1 seq&gt;1 src&gt;10.0.0.1/5000 dst&gt;10.0.0.2/5002 sent&gt;22:59:52.310324 size&gt;1024</code></p><p><code class="literal">23:59:53.312721 RECV proto&gt;&lt;protocol&gt; flow&gt;1 seq&gt;2 src&gt;10.0.0.1/5000 dst&gt;10.0.0.2/5002 sent&gt;22:59:52.310324 size&gt;1024 host&gt;10.0.0.1/5000 gps&gt;CURRENT,35.123,79.234,57</code></p><p><code class="literal">23:59:53.312721 RECV proto&gt;&lt;protocol&gt; flow&gt;1 seq&gt;2 src&gt;10.0.0.1/5000 dst&gt;10.0.0.1/5002 sent&gt;22:59:52.310324 size&gt;1024 host&gt;10.0.0.1/5000 gps&gt;CURRENT,35.123,79.234,57 data&gt;10:01a97b34458cff0021e8</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_RERR"></a>7.3.&nbsp;Log File RERR Events</h3></div></div></div><p>The format of the RERR (Receive Error) event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; RERR proto&gt;&lt;protocol&gt; type&gt;&lt;errorType&gt; src&gt;&lt;addr&gt;/&lt;port&gt;</code></p><p>The &lt;eventTime&gt; corresponds to when the message in error was received. The &lt;errorType&gt; is one of "none", "version", "checksum", or "dstaddr". An receive error of type "version" indicates the MGEN sender is using an mgen executable with an incompatible version number. The "checksum" error indicates the received message failed checksum validation, and the "dstaddr" error indicates an invalid or unsupported destination address type in the MGEN message received. The &lt;src&gt; attribute indicates the source address of the message in error.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_SEND_Events"></a>7.4.&nbsp;Log File SEND Events</h3></div></div></div><p>The format of the SEND event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; SEND proto&gt;&lt;protocol&gt; flow&gt;&lt;flowId&gt; seq&gt;&lt;sequenceNumber&gt; src&gt;&lt;srcPort&gt; dst&gt;&lt;addr&gt;/&lt;port&gt; size&gt;&lt;bytes&gt; [host&gt;&lt;addr&gt;/&lt;port&gt;]</code></p><p>The &lt;eventTime&gt; corresponds to when the message was sent, and it should precisely match the &lt;txTime&gt; logged by the machine the packet is sent to, if the packet is received correctly.</p><p>All the data items are the same as those used in the Log File RECV Events.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_JOIN"></a>7.5.&nbsp;Log File JOIN Events</h3></div></div></div><p>The format of the JOIN log file event line is:</p><p>&lt;eventTime&gt; JOIN group&gt; &lt;groupAddress&gt; [src&gt; &lt;srcAddress&gt;] [interface&gt; &lt;interfaceName&gt;]</p><p>The &lt;groupAddress&gt; is the IP multicast group address which was joined. The format of this field is either a dotted decimal IPv4 address or a colon-delimited IPv6 address. The &lt;interfaceName&gt; is given only when the executed MGEN script used the INTERFACE option in the corresponding <a class="link" href="#_JOIN" title="5.3.3.&nbsp;JOIN">JOIN</a> script event.</p><p>Example JOIN event log lines:</p><p><code class="literal">22:59:50:234757 JOIN group&gt;224.1.2.3</code></p><p><code class="literal">22:59:51:129574 JOIN group&gt;224.1.2.4 interface&gt;eth1</code></p><p><code class="literal">22:59:51:129574 JOIN group&gt;224.1.2.4 src&gt;25.25.25.1 interface&gt;eth1</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_LEAVE"></a>7.6.&nbsp;Log File LEAVE Events</h3></div></div></div><p>The format of log file LEAVE event lines is:</p><p>&lt;eventTime&gt; LEAVE group&gt;&lt;groupAddress&gt; [src&gt; &lt;srcAddress&gt;] [interface&gt;&lt;interfaceName&gt;]</p><p>The &lt;groupAddress&gt; is the IP multicast group address which was left. The format of this field is either a dotted decimal IPv4 address or a colon-delimited IPv6 address. The &lt;interfaceName&gt; is given only when the executed MGEN script used the INTERFACE option in the corresponding <a class="link" href="#_LEAVE" title="5.3.4.&nbsp;LEAVE">LEAVE</a> script event.</p><p>Example LEAVE event log lines:<code class="literal"></code></p><p><code class="literal">22:59:59:234757 LEAVE group&gt;224.1.2.3</code></p><p><code class="literal">22:59:59:753683 LEAVE group&gt;224.1.2.4 interface&gt;eth1</code></p><p><code class="literal">22:59:59:753683 LEAVE group&gt;224.1.2.4 src&gt;25.25.25.1 interface&gt;eth1</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_LISTEN"></a>7.7.&nbsp;Log File LISTEN Events</h3></div></div></div><p>The format of the LISTEN event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; LISTEN proto&gt;&lt;protocol&gt; port&gt;&lt;portNumber&gt;</code></p><p>The &lt;protocol&gt; field corresponds to the transport protocol type being used. Supported protocols include "UDP" and "TCP". The &lt;portNumber&gt; field is the host port number to be monitored.</p><p>Example LISTEN event log lines:<code class="literal"></code></p><p><code class="literal">22:59:48:834205 LISTEN proto&gt;UDP port&gt;5000</code></p><p><code class="literal">22:59:49:328039 LISTEN proto&gt;UDP port&gt;5001</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_IGNORE"></a>7.8.&nbsp;Log File IGNORE Events</h3></div></div></div><p>The format of the IGNORE event log file line is:</p><p><code class="literal">&lt;eventTime&gt; IGNORE proto&gt;&lt;protocol&gt; port&gt;&lt;portNumber&gt;</code></p><p>The &lt;protocol&gt; field corresponds to the transport protocol type which was being used. Supported protocols include "UDP" and "TCP". The &lt;portNumber&gt; field is the host port number to be no longer monitored.</p><p>Example IGNORE event log lines:<code class="literal"></code></p><p><code class="literal">23:00:00:723467 IGNORE proto&gt;UDP port&gt;5000</code></p><p><code class="literal">23:01:00:235629 IGNORE proto&gt;UDP port&gt;5001</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_ON"></a>7.9.&nbsp;Log File ON Events</h3></div></div></div><p>The format of the ON event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; ON flow&gt;&lt;flowID&gt; srcPort&gt;&lt;srcPort&gt; dst&gt;&lt;dst&gt;/&lt;portNumber&gt;</code></p><p>This event indicates that mgen has attempted to establish a TCP connection with the target destination address and port or a UDP flow has begun transmitting. It does not indicate that the connection has been successfully established, only that a connection has been attempted. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection. The &lt;srcPort&gt; is either the OS provided or user specified src port for the flow. The &lt;dst&gt; field corresponds to the destination of the TCP connection. The &lt;portNumber&gt; field is the destination port number of the TCP connection.</p><p>Example ON event log lines:</p><p><code class="literal">23:00:00:723467 ON flow&gt;1 srcPort&gt;4000 dst&gt;10.0.0.1/5000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_CONNECT"></a>7.10.&nbsp;Log File CONNECT Events</h3></div></div></div><p>The &lt;protocol&gt; field corresponds to the transport protocol type which was being used. Supported protocols include "UDP" and "TCP".</p><p>The format of the CONNECT event log file line is:</p><p>&lt;eventTime&gt; CONNECT flow&gt;&lt;flowId&gt; srcPort&gt;&lt;srcPort&gt; dst&gt;&lt;dst&gt;/&lt;portNumber&gt;</p><p>The &lt;src&gt; and &lt;dst&gt; fields correspond to the local source port and destination ip address/port of the TCP connection. The &lt;flowID&gt; is the transmitting flow id. If multiple flows are sharing the connection, CONNECT events will be logged for each flow.</p><p>Example CONNECT event log line:<code class="literal"></code></p><p><code class="literal">23:00:00:723467 CONNECT flow&gt;1 srcPort&gt;4000 dst&gt;10.0.0.2/5000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_ACCEPT"></a>7.11.&nbsp;Log File ACCEPT Events</h3></div></div></div><p>The &lt;protocol&gt; field corresponds to the transport protocol type which was being used. Supported protocols include "UDP" and "TCP".</p><p>The format of the ACCEPT event log file line is:</p><p>&lt;eventTime&gt; ACCEPT srcPort&gt;&lt;srcAddr&gt;&lt;srcPort&gt; dstPort&gt;&lt;dstPort&gt;</p><p>The &lt;src&gt; and &lt;dst&gt; fields correspond to the source ip address and port and local receiving(dst) port of the TCP connection.</p><p>Example ACCEPT event log line (server):</p><p>23:00:00:723467 ACCEPT srcPort&gt;4007 dst&gt;10.0.0.2/5000</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_SHUTDOWN"></a>7.12.&nbsp;Log File SHUTDOWN Events</h3></div></div></div><p>The format of the SHUTDOWN event log file line is:</p><p>&lt;eventTime&gt; SHUTDOWN flow&gt;&lt;flowID&gt; srcPort&gt;&lt;srcPort&gt; dst&gt;&lt;dstAddr&gt;&lt;dstPort&gt; (client)</p><p>&lt;eventTime&gt; SHUTDOWN src&gt;&lt;srcAddr&gt;&lt;srcPort&gt; dstPort&gt;&lt;dstPort&gt; (server)</p><p>This event indicates that a TCP connection with the dst indicated address and port was shutdown after a client OFF event or by the server after a server IGNORE event has been processed and client connections remain active on the dst port being listened to. In the TCP client's log file, the dst address and port reflect the address and port of the node the client was attempting to connect to. In the TCP server's log file, the src address and port reflects the address and port of the connecting node. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection (this field is only available in the client's event log). Note that if a TCP connection was prematurely terminated, no SHUTDOWN event will be logged.</p><p>Example Client SHUTDOWN event log line (client):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 SHUTDOWN flow&gt;&lt;flowId&gt; src&gt;10.0.0.2/5000 dstPort&gt;6000</code></p><p>Example Server SHUTDOWN event log line (server):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 SHUTDOWN src&gt;10.0.0.1/5000 dst&gt;6000</code></p><p>If multiple flows are sharing the same connection, the shutdown event will be logged only when the last flow has stopped sending to the socket pair. An "OFF" event will be logged for any connections ending while other flows are still transmitting, e.g.:</p><p><code class="literal">22:35:52.458531 OFF flow&gt;1 srcPort&gt;4000 dst&gt;10.0.0.1/5000 </code></p><p><code class="literal">22:35:52.458542 SEND proto&gt;TCP flow&gt;2 seq&gt;3 srcPort&gt;4000 dst&gt;10.0.0.1/5000 size&gt;8192</code></p><p><code class="literal">22:35:52.458598 SHUTDOWN flow&gt;2 srcPort&gt;4000 dst&gt;10.0.0.1/5000 </code></p><p><code class="literal">22:35:52.460419 OFF flow&gt;2 srcPort&gt;4000 dst&gt;10.0.0.1/5000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_DISCONNECTED"></a>7.13.&nbsp;Log File DISCONNECT Events</h3></div></div></div><p>The format of the DISCONNECT event log file line is:</p><p>&lt;eventTime&gt; DISCONNECT flow&gt;&lt;flowID&gt; srcPort&gt;&lt;srcPort&gt; dst&gt;&lt;dstAddr&gt;&lt;dstPort&gt; (client)</p><p>&lt;eventTime&gt; DISCONNECT src&gt;&lt;srcAddr&lt;/&lt;srcPort&gt; dstPort&gt;&lt;dstPort&gt; (server)</p><p>This event indicates that a TCP connection with the indicated address and port has disconnected either because the connection could not be established in the first place or because the connection was prematurely terminated. In the TCP client's log file, the dst address and port reflect the address and port of the node the client was attempting to connect to. In the TCP server's log file, the src address and port reflects the address and port of the connecting node. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection (this field is only available in the client's event log). Note that if a TCP connection was not prematurely terminated, no DISCONNECT event will be logged. (NOTE: Indication of unscheduled TCP disconnection is not available relieably under windows at this time.)</p><p>Example Client DISCONNECT event log line:<code class="literal"></code></p><p><code class="literal">23:00:00:723467 DISCONNECT flow&gt;1 srcPort&gt;4000 dst&gt;10.0.0.2/5000</code></p><p>Example Server DISCONNECT event log line :<code class="literal"></code></p><p><code class="literal">23:00:00:723467 DISCONNECT src&gt;10.0.0.1/4000 dstPort&gt;5000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_RECONNECT"></a>7.14.&nbsp;Log File RECONNECT Events</h3></div></div></div><p>The format of the RECONNECT event log file line is:</p><p>&lt;eventTime&gt; RECONNECT flow&gt;&lt;flowID&gt; srcPort&gt;&lt;srcPort&gt; dst&gt;&lt;dstAddr&gt;&lt;dstPort&gt; (client)</p><p>This event indicates an attempt to reconnect a TCP connection with the indicated address and port that has disconnected either because the connection could not be established in the first place or because the connection was prematurely terminated. In the TCP client's log file, the dst address and port reflect the address and port of the node the client was attempting to connect or reconnect to. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection. Note that if multiple flows are sharing a TCP socket reconnect events will be logged for each flow.</p><p>Example Client RECONNECT event log line:<code class="literal"></code></p><p><code class="literal">23:00:00:723467 DISCONNECT flow&gt;1 srcPort&gt;4000 dst&gt;10.0.0.2/5000</code></p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_OFF"></a>7.15.&nbsp;Log File OFF Events</h3></div></div></div><p>The format of the OFF event log file line is:</p><p>&lt;eventTime&gt; OFF flow&gt; &lt;flowID&gt; srcPort&gt;&lt;srcPort&gt; dst&gt;&lt;dstAddr&gt;/&lt;dstPort&gt; (client)</p><p>&lt;eventTime&gt; OFF src&gt;&lt;srcAddr&gt;&lt;srcPort&gt; dstPort&gt;&lt;dstPort&gt; (server)</p><p>This event indicates that a TCP connection with the indicated address and port has been successfully shutdown (e.g. disconnected) after a scheduled mgen OFF event. In the TCP client's log file, the dst address and port reflect the address and port of the node the client was connected to. In the TCP server's log file, the src address and port reflects the address and port of the connecting node. The &lt;flowID&gt; field corresponds to the TCP flow ID of the connection (this field is only available in the client's event log). Note that if a TCP connection was prematurely terminated by either the client or the server, a DISCONNECT event will be logged instead of an OFF event. (NOTE: Under Windows operating systems, the DISCONNECT event is not reliable and the OFF event may be logged for both planned and unplanned socket disconnects.)</p><p>Example Client OFF event log line (client):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 OFF flow&gt;1 srcPort&gt;4000 dst&gt;10.0.0.2/5000</code></p><p>Example Server OFF event log line (server):<code class="literal"></code></p><p><code class="literal">23:00:00:723467 OFF src&gt;10.0.0.1/4000 dstPort&gt;5000</code></p><p>Note that the server will only log a single OFF event if multiple tcp flows are being recevied over the socket pair, although the client will log OFF events for each flow.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Log_File_Start_Stop"></a>7.16.&nbsp;Log File START and STOP Events</h3></div></div></div><p>The format of the START and STOP event log file line is:<code class="literal"></code></p><p><code class="literal">&lt;eventTime&gt; START</code>or<code class="literal">&lt;eventTime&gt;STOP</code></p><p>These log file lines indicate the time at which MGEN began and ended its operation. The "START" time corresponds to the relative time zero for any executed scripts. This "START" time is when the mgen program was executed unless the global <a class="link" href="#_START" title="6.1.&nbsp;START">START</a> command was invoked. The "STOP" command corresponds to when the mgen program was halted.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_LOG_FILE_REPORT_EVENTS"></a>7.17.&nbsp;Log File REPORT Events</h3></div></div></div><p>The format of locally source REPORT events is (note the offset will be 0.0 and there is no "sent&gt;" field):</p><p><code class="literal">01:17:01.983235 REPORT proto&gt;UDP flow&gt;3 src&gt;127.0.0.1/63684 dst&gt;127.0.0.1/5002 offset&gt;0.000000 window&gt;1.970563 rate&gt;10.000000 kbps loss&gt;0.000000 latency ave&gt;0.000119 min&gt;0.000109 max&gt;0.000129</code></p><p>The format of REPORT events from remote nodes includes the "sent&gt;" field:</p><p><code class="literal">01:17:01.983235 REPORT proto&gt;UDP flow&gt;3 src&gt;127.0.0.1/63684 dst&gt;127.0.0.1/5002 sent&gt;01:16.58.675309 offset&gt;0.023000 window&gt;1.970563 rate&gt;10.000000 kbps loss&gt;0.000000 latency ave&gt;0.000119 min&gt;0.000109 max&gt;0.000129</code></p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Binary_Log_File_Format"></a>8.&nbsp;Binary Log File Format</h2></div></div></div><p>At the beginning of binary log files, there is a plain text line to make it easy to tell what kind of file it is. It has the mgen version number, as well as the type of file ("binary_log"). This line is terminated with a line feed and a NULL ('\0') character. Following the NULL, the file contains a series of binary formatted records. There are several different types of records in the binary log file format. Each record consists of a number of fields. The first single-byte field indicates the record type. A record type of 0 is considered invalid. All multiple-byte fields are in standard network byte order (i.e. most significant byte first). Each record in the binary log file corresponds to a single unique Mgen event, just as each line in the text-based log file does. Each binary log file record contains the same information that every line of the text-format log file has. The text-format log file can actually be recreated from a binary log file using the "convert" command of mgen.</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="_Binary_Log_File_RECV_Events"></a>8.1.&nbsp;Binary Log File RECV Events</h3></div></div></div><p>The format of the RECV event binary log file record is:</p><pre class="programlisting">
The format of the RECV event binary log file record is:

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    type = 1   |   protocol    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            srcPort            |  srcAddrType  |  srcAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          srcAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          messageSize          |    version    |    flags      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          mgenFlowId                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        sequenceNumber                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         txTimeSeconds                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       txTimeMicroseconds                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            dstPort            |  dstAddrType  |  dstAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          dstAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           hostPort            | hostAddrType  | hostAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         hostAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            latitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           longitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            altitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   gpsStatus   |  reserved   |           payloadLen            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          payload ...                          |
</pre><p>The &lt;type&gt; field contains the record type. The record type for RECV events is 1. For backwards compatibility, unknown record types are skipped by the binary to text log file conversion function. The &lt;protocol&gt; field indicates the protocol of the message UDP &lt;1&gt;, TCP &lt;2&gt;, or SINK &lt;3&gt;. &lt;0&gt; indicates an invalid protocol.</p><p>The &lt;eventRecordLength&gt; field contains the length of this record, starting with the next byte. Thus, it contains the length of the entire record, less what will have already been read when this two-byte number is obtained.</p><p>The &lt;srcPort&gt; field contains the port number that the message was sent from. The &lt;srcAddrType&gt; field indicates the type of the source. Possible types and values include:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_ADDRESS</td><td>0</td></tr><tr><td>IPv4</td><td>1</td></tr><tr><td>IPv6</td><td>2</td></tr></tbody></table></div><p>The &lt;srcAddrLen&gt; field indicates the length in bytes of source address field &lt;srcAddr&gt; to follow. The length should be 0 (zero) for the INVALID_ADDRESS type, 4 for IPv4 addresses, and 16 for IPv6 addresses.</p><p>The &lt;srcAddr&gt; contains the address to which the MGEN message was sent from. The address is in network byte order.</p><p>The rest of the packet is just a copy of the message payload from the original packet. For details on these fields, please look <a class="link" href="#_MGEN_Message_Payload" title="9.&nbsp;MGEN Message Payload">here</a>.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_TCP_Connection_Event"></a>8.2.&nbsp;Binary Log File TCP Connection Events</h3></div></div></div><p>The format of the TCP connection event binary log file records is:</p><pre class="programlisting">
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    type = 1   |   protocol    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       srcPort/dstPort         |   addrType    |     addrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       srcAddr/dstAddr ...                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       srcPort/DstPort         |           flowID              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      (flowID cont.)           |   addrLen     |    hostAddr   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  (host addr cont)             |       
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><p>The &lt;type&gt; field contains the record type. The record type for TCP corresponds to the tcp event type (ON, CONNECT, DISCONNECT, RECONNECT, OFF). The &lt;protocol&gt; field indicates the protocol of the message TCP &lt;2&gt;. &lt;0&gt; indicates an invalid protocol.</p><p>The &lt;eventRecordLength&gt; field contains the length of this record, starting with the next byte. Thus, it contains the length of the entire record, less what will have already been read when this two-byte number is obtained.</p><p>The &lt;flowID&gt; field indicates whether the event is a client or server event. A flowID indicates that the event is a TCP client event. A &lt;0&gt; flowID indicates that the event is a TCP server event. The &lt;port&gt; field contains the port number that the message was sent to/from. The &lt;addrType&gt; field indicates the type of the address. Possible types and values include:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_ADDRESS</td><td>0</td></tr><tr><td>IPv4</td><td>1</td></tr><tr><td>IPv6</td><td>2</td></tr></tbody></table></div><p>The &lt;addrLen&gt; field indicates the length in bytes of source address field &lt;addr&gt; to follow. The length should be 0 (zero) for the INVALID_ADDRESS type, 4 for IPv4 addresses, and 16 for IPv6 addresses.</p><p>The &lt;addr&gt; contains the address to which the MGEN message was sent to/from. The address is in network byte order.</p><p>The &lt;flowID&gt; indicates the flow id of the tcp connection on the server side only. Host address fields are included if available.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_RERR_Events"></a>8.3.&nbsp;Binary Log File RERR Events</h3></div></div></div><p>The format of the RERR (receive error) event binary log file record is:</p><pre class="programlisting">
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    type = 1   |   protocol    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            srcPort            |  srcAddrType  |  srcAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          srcAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          errorType                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>The &lt;type&gt; field contains the record type. The record type for RECV events is 1. For backwards compatibility, unknown record types are skipped by the binary to text log file conversion function. The &lt;protocol&gt; field indicates the protocol of the message UDP &lt;1&gt;, TCP &lt;2&gt;, or SINK &lt;3&gt;. &lt;0&gt; indicates an invalid protocol.</p><p>The &lt;eventRecordLength&gt; field contains the length of this record, starting with the next byte. Thus, it contains the length of the entire record, less what will have already been read when this two-byte number is obtained.</p><p>The &lt;srcPort&gt; field contains the port number that the message was sent from. The &lt;srcAddrType&gt; field indicates the type of the source Possible types and values include:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_ADDRESS</td><td>0</td></tr><tr><td>IPv4</td><td>1</td></tr><tr><td>IPv6</td><td>2</td></tr></tbody></table></div><p>The &lt;srcAddrLen&gt; field indicates the length in bytes of source address field &lt;srcAddr&gt; to follow. The length should be 0 (zero) for the INVALID_ADDRESS type, 4 for IPv4 addresses, and 16 for IPv6 addresses.</p><p>The &lt;srcAddr&gt; contains the address to which the MGEN message was sent from. The address is in network byte order.</p><p>The &lt;errorType&gt; indicates the type of message error detected and is one of the following possible error type values:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>No error</td><td>0</td></tr><tr><td>Version number mismatch</td><td>1</td></tr><tr><td>Checksum validation failure</td><td>2</td></tr><tr><td>Message length error</td><td>3</td></tr><tr><td>Destination address invalid</td><td>4</td></tr></tbody></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_SEND_Events"></a>8.4.&nbsp;Binary Log File SEND Events</h3></div></div></div><p>SEND events are only logged if transmit logging has been turned on with the "txlog" option. The format of the SEND event binary log file record is:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    type = 2   |   protocol    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        TCP message size                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          messageSize          |    version    |    flags      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          mgenFlowId                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        sequenceNumber                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         txTimeSeconds                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       txTimeMicroseconds                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            dstPort            |  dstAddrType  |  dstAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          dstAddr ...                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           hostPort            | hostAddrType  | hostAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         hostAddr ...                          |
</pre><p>These fields are the same ones that are used in the <a class="link" href="#_Binary_Log_File_RECV_Events" title="8.1.&nbsp;Binary Log File RECV Events">RECV</a> events. The &lt;type&gt; for SEND events is 2. The &lt;protocol&gt; field indicates the protocol of the message UDP &lt;1&gt;, TCP &lt;2&gt;, or SINK &lt;3&gt;. &lt;0&gt; indicates an invalid protocol. Immediately following the &lt;eventRecordLength&gt; is a copy of the original message payload, without the GPS data and payload. The event time is left out, since it is the same as the transmit time. TCP message size will only exist for TCP protocol send events.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_LISTEN_IGNORE_Event"></a>8.5.&nbsp;Binary Log File LISTEN/IGNORE Events</h3></div></div></div><p>LISTEN and IGNORE events both have the same format:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  type = 3/4   |   protocol    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   protocol    |   reserved    |          portNumber           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>LISTEN events have a &lt;type&gt; of 3, while IGNORE events have a &lt;type&gt; of 4. The &lt;protocol&gt; field contains the transport protocol type to LISTEN for, while the &lt;portNumber&gt; field tells us what port number to LISTEN on. Possible types and values for the &lt;protocol&gt; include:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_PROTOCOL</td><td>0</td></tr><tr><td>UDP</td><td>1</td></tr><tr><td>TCP</td><td>2</td></tr></tbody></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_JOIN_LEAVE_Event"></a>8.6.&nbsp;Binary Log File JOIN/LEAVE Events</h3></div></div></div><p>JOIN and LEAVE events also have an identical format:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  type = 5/6   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           groupPort           | groupAddrType | groupAddrLen  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         groupAddr ...                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| ifaceNameLen  |             asciiInterfaceName ...            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     asciiInterfaceName ...                    |]
</pre><p>JOIN events are of &lt;type&gt; 5, and LEAVE events have a &lt;type&gt; of 6. The &lt;groupPort&gt; is the port which will be used to JOIN/LEAVE the group. The &lt;groupAddrType&gt;, &lt;groupAddrLen&gt;, and &lt;groupAddr&gt; are the type, length, and raw value of the group address, similar to those of addresses in other record types. The ifaceNameLen field contains the length in bytes of the &lt;asciiInterfaceName&gt; that follows it.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="Binary_Log_File_START_STOP_Event"></a>8.7.&nbsp;Binary Log File START/STOP Events</h3></div></div></div><p>START and STOP events both have the same format:</p><pre class="programlisting">
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  type = 7/8   |   reserved    |       eventRecordLength       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       eventTimeSeconds                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     eventTimeMicroseconds                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><p>START events have a &lt;type&gt; 7, while STOP events are of &lt;type&gt; 8. They contain only the time the event occurred.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_MGEN_Message_Payload"></a>9.&nbsp;MGEN Message Payload</h2></div></div></div><p>Note that the Version 5.0 message format is slightly different than that of MGEN Version 4.0. The MGEN message payload is in the following format:</p><pre class="programlisting">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          messageSize          |    version    |    flags      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          mgenFlowId                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        sequenceNumber                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         txTimeSeconds                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       txTimeMicroseconds                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            dstPort            |  dstAddrType  |  dstAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          dstAddr ...                          |
                                                                
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           hostPort            | hostAddrType  | hostAddrLen   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         hostAddr ...                          |
                                                                 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            latitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           longitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            altitude                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   gpsStatus   |  reserved   |           payloadLen            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          payload ...                          |
                                                                 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          padding ...                          |
                                                                 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          checksum                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><p>All multiple-byte fields are in standard network byte order (i.e. most significant byte first).</p><p>The &lt;messageSize&gt; field indicates the total size (including the &lt;messageSize&gt;, &lt;version&gt;, &lt;flags&gt;, etc fields) of the MGEN message in bytes. The current UDP-only transport limits this to a maximum of 8192 bytes. In the future, larger message sizes will be supported and in conjunction with the &lt;flags&gt; field, very large messages will be supported as a concatenation of MGEN messages to support emulation of large file transfers, etc.</p><p>The &lt;version&gt; field is the MGEN message protocol version number. This will enable future versions of MGEN to b backwards compatible and prevent older versions of MGEN from attempting to parse packets in unknown format.</p><p>Currently a single &lt;flags&gt; value (CHECKSUM = 0x01) is defined. When this flag is set, it indicates the presence of the &lt;checksum&gt; field at the end of the MGEN message. It is expected that additional flags will be useful as MGEN adds support for transport types besides UDP.</p><p>The &lt;mgenFlowId&gt; contains the flow/thread identification value associated with the MGEN flow in the corresponding script which created the flow. Note that each flow identified from an MGEN source has its own sequence number space.</p><p>The &lt;sequenceNumber&gt; contains the 32-bit sequence number which is incremented with each message generated for an MGEN flow. This will wrap to zero when the maximum is reached.</p><p>The &lt;txTimeSeconds&gt; and &lt;txTimeMicroseconds&gt; fields are used to mark the time of transmission of the MGEN message. The time is the source computer's system time in Greenwich Mean Time (GMT).</p><p>The &lt;dstPort&gt; is the destination port number to which the MGEN message addressed by the source.</p><p>The &lt;dstAddrType&gt; field indicates the type of destination address encapsulated in following fields. Possible types and values include:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_ADDRESS</td><td>0</td></tr><tr><td>IPv4</td><td>1</td></tr><tr><td>IPv6</td><td>2</td></tr></tbody></table></div><p>The &lt;dstAddrLen&gt; field indicates the length in bytes of the destination address field &lt;dstAddr&gt; to follow. The length should be 0 (zero) for the INVALID_ADDRESS type, 4 for IPv4 addresses, and 16 for IPv6 addresses.</p><p>The &lt;dstAddr&gt; contains the destination address to which the source addressed the MGEN message. The address is in network byte order.</p><p>Note that the following fields are optional and the MGEN message length my be truncated at any point after here. Any incomplete optional fields are considered invalid.</p><p>The &lt;hostPort&gt; and &lt;hostAddr&gt; (if present and valid) contain the MGEN message source's default local address. Note that this may be different from the source address contained in the MGEN log file due to firewalls, Network Address Translation (NAT) devices, multi-homed sources, etc.</p><p>The &lt;hostPort&gt; is the destination port number to which the MGEN message was addressed by the source.</p><p>The &lt;hostAddrType&gt; field indicates the type of destination address encapsulated in following fields. The possible values are the same as for the &lt;dstAddrType&gt; described above.</p><p>The &lt;hostAddrLen&gt; field indicates the length in bytes of the destination address field &lt;hostAddr&gt; to follow.</p><p>The &lt;hostAddr&gt; contains the source's perception of its local default network address. In mgen, this is determined by a system call to <code class="literal">gethostname()</code>, followed by a call to name resolution. This address may be incorrect if the host is not correctly configured or domain name service (DNS) is unavailable.</p><p>The &lt;latitude&gt;, &lt;longitude&gt;, and &lt;altitude&gt; fields contain values corresponding to GPS information for the MGEN source if it was available. The &lt;latitude&gt; and &lt;longitude&gt; fields are encoded as follows:</p><p>&lt;fieldValue&gt; = (unsigned long)((&lt;actualValue&gt;+180.0)*60000.0)</p><p>The &lt;altitude&gt; field is the direct representation of the altitude value available from the source's GPS system.</p><p>The &lt;gpsStatus&gt; indicates the validity of the GPS information which was encoded. Possible status types and values currently include:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>INVALID_GPS</td><td>0</td></tr><tr><td>STALE</td><td>1</td></tr><tr><td>CURRENT</td><td>2</td></tr></tbody></table></div><p>In addition to the &lt;gpsStatus&gt; field, actual values of 999.0 for latitude and longitude, and ?999 for altitude also correspond to invalid values.</p><p>The &lt;payloadLen&gt; field, when of non-zero value, indicates the presence of optional user-defined content in the MGEN message. The &lt;payloadLen&gt; value indicates the quantity (in bytes) of user-defined content which follows.</p><p>The &lt;payload&gt; field contains the user-defined content and is of length &lt;payloadLen&gt; bytes. Note that a short MGEN &lt;messageSize&gt; could truncate this field. If the MGEN user provides the optional user-defined content, it is up to the user to ensure that the generated MGEN messages are of sufficient size as not to truncate the &lt;payload&gt; content.</p><p>The &lt;padding&gt; portion of MGEN messages contain undefined data content.</p><p>The &lt;checksum&gt; field is optional and is present when the CHECKSUM (0x01) flag is set in the &lt;flags&gt; field. Note that corrupted messages may result in MGEN messages with the &lt;flags&gt; field itself corrupted, so it may be useful for MGEN implementations to have an option to validate checksums even when the CHECKSUM flag is not set if it is known that the sender is providing checksum content.</p><p>Note: The total size of the MGEN message is defined by the &lt;messageSize&gt; field. The optional fields may be truncated if the &lt;messageSize&gt; is small. The minimum MGEN message size will depend upon the IP address types being used. For example, the minimum allowed MGEN message size using IPv4 addresses with no optional fields is 28 bytes (i.e. for UDP, the UDP payload size would be 28 bytes). If GPS information is to be included without truncation, the minimum message size becomes 52 bytes with the inclusion of the &lt;hostAddr&gt; and GPS information. For IPv6 destination addresses, the minimum allowed MGEN message size is 40 bytes with no optional fields. If GPS information is included the minimum message size with truncating information is 76 bytes.</p></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3479"></a>10.&nbsp;Compile options</h2></div></div></div><p></p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3483"></a>10.1.&nbsp;RANDOM_FILL</h3></div></div></div><p>Adding the RANDOM_FILL compile time option will cause MGEN to fill the payload with random content. Otherwise, the payload will be zero filled. (Alternatively, the DATA option may be used).</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3488"></a>10.2.&nbsp;HAVE_IPV6</h3></div></div></div><p>The HAVE_IPV6 compile time option indicates that the system is IPV6 capable. IPV6 packets will be generated.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3493"></a>10.3.&nbsp;SIMULATE</h3></div></div></div><p>The SIMULATE compile time option indicates that MGEN will be running in a simulation environment.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3498"></a>10.4.&nbsp;HAVE_GPS</h3></div></div></div><p>The HAVE_GPS compile time option indicates that a GPS service is available. GPS information will be put into the MGEN message payload.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3503"></a>10.5.&nbsp;HAVE_PCAP</h3></div></div></div><p>The HAVE_PCAP compile time option indicates that the system has PCAP installed. This option should be used when MGEN will be "cloning" a TCPDUMP file.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3508"></a>10.6.&nbsp;Other</h3></div></div></div><p>Operating system compile time options include UNIX, _WIN32_WCE, WIN32, LINUX, MACOSX. These should be set as appropriate to the operation system type. UNICODE log file output may be specified for WIN32 operating systems. On Solaris (and possibly other Unix) operating systems, the IP_MAX_MEMBERSHIPS option will set the IP_MAX_MEMBERSHIP limit per socket to -1 as no pre-defined limit is set in the OS.</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3513"></a>11.&nbsp;Known issues</h2></div></div></div><p></p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3517"></a>11.1.&nbsp;Macosx Windows TCP Interaction</h3></div></div></div><p>There is a negative interaction between Nagle's TCP Algorithm and Delayed ACK that causes a TCP performance delay between traffic flowing from some Windows OSs to macosx. This can be alleviated somewhat by setting the sysctl net.inet.tcp.delayed_ack value to 1 (always employ delayed ack, 6 packets can get 1 ack) although performance may still be still be impacted. Windows-7 is impacted more than Vista. The phenomenon varies by traffic pattern.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3522"></a>11.2.&nbsp;Windows Buffer Sizes</h3></div></div></div><p>As windows default buffer size 8192K it is recommended that adequate rx/tx buffers be set for UDP traffic via the TXBUFFER and RXBUFFER global or flow commands so UDP performance is not degraded.</p><p></p></div></div></div></body></html>